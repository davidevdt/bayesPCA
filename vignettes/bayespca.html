<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Davide Vidotto d.vidotto@uvt.nl" />

<meta name="date" content="2020-06-02" />

<title>bayespca Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">bayespca Package</h1>
<h4 class="author">Davide Vidotto <a href="mailto:d.vidotto@uvt.nl">d.vidotto@uvt.nl</a></h4>
<h4 class="date">2020-06-02</h4>


<div id="TOC">
<ul>
<li><a href="#bayespca-a-package-for-variational-bayes-pca">bayespca: A package for Variational Bayes PCA</a><ul>
<li><a href="#theoretical-background">Theoretical background</a></li>
<li><a href="#the-bayespca-package">The <code>bayespca</code> package</a></li>
<li><a href="#levels-of-regularization-on-the-w-matrix">Levels of regularization on the W matrix</a><ul>
<li><a href="#fixed-tau">Fixed <code>tau</code></a></li>
<li><a href="#fixed-updatable-tau">Fixed, updatable <code>tau</code></a></li>
<li><a href="#random-tau-gamma-prior">Random <code>tau</code>: Gamma prior</a></li>
<li><a href="#global-prior-variances">Global prior variances</a></li>
</ul></li>
<li><a href="#automatic-relevance-determination">Automatic Relevance Determination</a></li>
<li><a href="#high-posterior-density-intervals">High posterior density intervals</a></li>
<li><a href="#retrieve-principal-components">Retrieve Principal Components</a><ul>
<li><a href="#references">References</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="bayespca-a-package-for-variational-bayes-pca" class="section level1">
<h1>bayespca: A package for Variational Bayes PCA</h1>
<div id="theoretical-background" class="section level2">
<h2>Theoretical background</h2>
<p>Principal Components Analysis (PCA) allows performing dimensionality reduction via matrix factorization. While there are several ways to express a PCA model, in what follows will we consider the formulation <span class="math display">\[ X = X W P^T + E, \]</span> where X is a <span class="math inline">\(I \times J\)</span> data matrix (<span class="math inline">\(I\)</span> is the number of units; <span class="math inline">\(J\)</span> the number of continuous variables); <span class="math inline">\(W\)</span> is a <span class="math inline">\(J \times D\)</span> weight matrix (<span class="math inline">\(D \leq J\)</span> is the rank of the reduced matrix); <span class="math inline">\(P\)</span> is the orthogonal loading matrix, such that <span class="math inline">\(P^T P = I_{D \times D}\)</span>; and <span class="math inline">\(E\)</span> is an <span class="math inline">\(I \times J\)</span> error matrix. The <span class="math inline">\(D\)</span> principal components can be retrieved with <span class="math inline">\(Z = X W\)</span>. In this context, the focus of the inference is typically on <span class="math inline">\(W\)</span>. In particular, when <span class="math inline">\(J\)</span> is large and the main inferential goal is components’ interpretation, it is important for the analyst to obtain simple and interpretable components.</p>
<p>The <code>bayespca</code> package allows performing the following operations:</p>
<ol style="list-style-type: decimal">
<li>estimation of the PCA model, with a Variational Bayes algorithm;<br />
</li>
<li>regularization of the elements of <span class="math inline">\(W\)</span> by means of its prior variances;</li>
<li>variable selection, via automatic relevance determination (ARD).</li>
</ol>
<p>The Variational Bayes algorithm sees the columns of <span class="math inline">\(W\)</span> as latent variables, and <span class="math inline">\(P\)</span> as a fixed parameter. Furthermore, the residuals <span class="math inline">\(E\)</span> are assumed to be distributed according to a Normal distribution with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>. The following prior is assumed for the <span class="math inline">\(d\)</span>-th column of <span class="math inline">\(W\)</span>:</p>
<p><span class="math display">\[ w_d \sim MVN(0, T_d^{-1})  \]</span></p>
<p>where <span class="math inline">\(MVN()\)</span> denotes the density of the Multivariate Normal Matrix, and <span class="math inline">\(T_d\)</span> denotes the prior (diagonal) precision matrix of the <span class="math inline">\(d\)</span>-th component. The <span class="math inline">\(j\)</span>-th element of the diagonal of <span class="math inline">\(T_d\)</span> will be denoted <span class="math inline">\(\tau_{dj}\)</span>.</p>
</div>
<div id="the-bayespca-package" class="section level2">
<h2>The <code>bayespca</code> package</h2>
<p>Variational Bayes PCA is implemented through the <code>vbpca</code> function, which takes the following arguments as inputs:</p>
<ul>
<li><code>X</code> the input matrix;</li>
<li><code>D</code> the number of components to be estimated;</li>
<li><code>nstart</code> number of times a different run of the algorithm is performed (with varying starting values);</li>
<li><code>maxIter</code> the maximum number of iterations for the Variational Bayes algorithm;</li>
<li><code>tolerance</code> convergence criterion of the algorithm (relative difference between ELBO values);</li>
<li><code>verbose</code> logical parameter which prints estimation information on screen when <code>TRUE</code>;</li>
<li><code>center</code> boolean indicating whether to center the variables in X;</li>
<li><code>scalecorrection</code>, a float which is &gt;= than 0 if the variables are scaled (by a factor <code>scalecorrection</code>), and &lt;0 otherwise;</li>
<li><code>svdStart</code>, a boolean denoting whether to use the values of SVD decomposition for the starting values (opposed to random starts);</li>
<li><code>tau</code> value of the prior precisions; starting value when <code>updatetau=TRUE</code> or <code>alphatau &gt; 0</code> (for Gamma priors)</li>
<li><code>updatetau</code> logical parameter denoting whether the prior precisions should be updated when <code>priorvar='fixed'</code>;</li>
<li><code>alphatau</code> values of the shape parameter of the Gamma priors for the precisions; prior precisions are fixed when set to 0</li>
<li><code>betatau</code> values of the scale parameter of the Gamma priors for the precisions;</li>
<li><code>plot.lowerbound</code> boolean indicating whether to plot the history of the ELBO values calculated during the variational iterations;<br />
</li>
<li><code>hpdi</code> logical indicating whether to calcualte the HPD intervals of the weights;</li>
<li><code>probHPDI</code> the probability density covered by the HPDI’s;<br />
</li>
<li><code>global.var</code> logical parameter which activates component-specific prior variances when set to <code>TRUE</code>;</li>
</ul>
<p><code>vbpca</code> returns a vbpca object, which is a list containing various aspect of the model results. See <code>?vbpca</code> for further information. Internally, <code>vbpca</code> calls a C++ function (written with Rcpp) to estimate the model. When <code>nstart</code>&gt;1, the algorithm will autmatically pick (and output) the best run in terms of final ELBO value.</p>
<p>In what follows, the various estimation modalities allowed by <code>vbpca</code> will be introduced. For presentation purposes, a synthetic data matrix with <span class="math inline">\(I = 100\)</span> rows and <span class="math inline">\(J = 20\)</span> columns genereted from three components will be used:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">141</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">I &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">J &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">V1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">V2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">V3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(V1, <span class="dv">7</span>), <span class="kw">rep</span>(V2, <span class="dv">7</span>), <span class="kw">rep</span>(V3, <span class="dv">6</span>)), I, J)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">X &lt;-<span class="st"> </span>X <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(I <span class="op">*</span><span class="st"> </span>J, <span class="dv">0</span>, <span class="dv">1</span>), I, J)</a></code></pre></div>
<p>I will now proceed with the estimation of the PCA model.</p>
</div>
<div id="levels-of-regularization-on-the-w-matrix" class="section level2">
<h2>Levels of regularization on the W matrix</h2>
<div id="fixed-tau" class="section level3">
<h3>Fixed <code>tau</code></h3>
<p>With fixed tau, it is possible to specify the model as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Install and load package</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># devtools::install_github(&quot;davidevdt/bayespca&quot;)</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(bayespca)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co"># Estimate vbpca with fixed prior precisions (equal to 1)</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># for the elements of W</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">mod1 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">alphatau=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">              <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">              <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">              <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># Test the class of mod1:</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="kw">is.vbpca</span>(mod1)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The estimate posterior means of the <span class="math inline">\(W\)</span> matrix can be viewed with:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">mod1<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##              Component 1 Component 2   Component 3
## variable 1  -0.376589700 -0.04416511  0.0003399127
## variable 2  -0.373939778 -0.04582346 -0.0111489595
## variable 3  -0.375148658 -0.04305857 -0.0078831845
## variable 4  -0.374770078 -0.04473100 -0.0031124941
## variable 5  -0.376808027 -0.04285792 -0.0100250681
## variable 6  -0.375114066 -0.04446329 -0.0015012124
## variable 7  -0.375069347 -0.04364081 -0.0007181138
## variable 8   0.043916074 -0.37610685 -0.0194987844
## variable 9   0.044338996 -0.37382690 -0.0224165536
## variable 10  0.043216238 -0.37319456 -0.0161965576
## variable 11  0.043432789 -0.37311089 -0.0246530518
## variable 12  0.045420158 -0.37574267 -0.0200072059
## variable 13  0.045158091 -0.37616395 -0.0206149568
## variable 14  0.044605651 -0.37571347 -0.0144837533
## variable 15  0.002905219  0.02229238 -0.4057459837
## variable 16  0.003409761  0.02199152 -0.4068881894
## variable 17  0.003232845  0.02063894 -0.4106993908
## variable 18  0.002919709  0.02319335 -0.4056785190
## variable 19  0.002019259  0.02192116 -0.4088024260
## variable 20  0.001874207  0.02043128 -0.4078308025</code></pre>
<p>and the <span class="math inline">\(P\)</span> matrix:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">mod1<span class="op">$</span>P</a></code></pre></div>
<pre><code>##              Component 1 Component 2   Component 3
## variable 1  -0.376589904 -0.04416517  0.0003399179
## variable 2  -0.373939981 -0.04582353 -0.0111491289
## variable 3  -0.375148862 -0.04305863 -0.0078833043
## variable 4  -0.374770282 -0.04473106 -0.0031125414
## variable 5  -0.376808232 -0.04285797 -0.0100252205
## variable 6  -0.375114270 -0.04446335 -0.0015012352
## variable 7  -0.375069551 -0.04364087 -0.0007181247
## variable 8   0.043916097 -0.37610735 -0.0194990808
## variable 9   0.044339020 -0.37382740 -0.0224168943
## variable 10  0.043216262 -0.37319506 -0.0161968038
## variable 11  0.043432813 -0.37311139 -0.0246534264
## variable 12  0.045420183 -0.37574317 -0.0200075099
## variable 13  0.045158115 -0.37616446 -0.0206152700
## variable 14  0.044605675 -0.37571398 -0.0144839734
## variable 15  0.002905220  0.02229241 -0.4057521497
## variable 16  0.003409762  0.02199155 -0.4068943728
## variable 17  0.003232846  0.02063897 -0.4107056321
## variable 18  0.002919710  0.02319338 -0.4056846840
## variable 19  0.002019260  0.02192119 -0.4088086384
## variable 20  0.001874208  0.02043131 -0.4078370001</code></pre>
<p>Among other things, the function returns the model evidence lower bound (ELBO) and the estimation time:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">mod1<span class="op">$</span>elbo</a></code></pre></div>
<pre><code>## [1] -2834.277</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">mod1<span class="op">$</span>time</a></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.00    0.01    0.01</code></pre>
</div>
<div id="fixed-updatable-tau" class="section level3">
<h3>Fixed, updatable <code>tau</code></h3>
<p>The prior precisions <span class="math inline">\(\tau_{dj}\)</span> can also be updated via Type-II Maximum Likelihood (empirical Bayes updates):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">mod2 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">alphatau=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">             <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">center =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">             <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">             <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">             <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">mod2<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##               Component 1  Component 2  Component 3
## variable 1  -3.774720e-01 -0.051470102 -0.001822156
## variable 2  -3.744848e-01 -0.025307896 -0.002337156
## variable 3  -3.747070e-01 -0.039179989 -0.002345241
## variable 4  -3.697882e-01 -0.062258504 -0.002242303
## variable 5  -3.794353e-01 -0.031311390 -0.002225193
## variable 6  -3.811333e-01 -0.058594825 -0.001901847
## variable 7  -3.709497e-01 -0.037084346 -0.001895318
## variable 8   4.572526e-02 -0.388171353 -0.019796029
## variable 9   4.119102e-02 -0.376636645 -0.023267758
## variable 10  2.518537e-02 -0.376940208 -0.006967316
## variable 11  5.297341e-02 -0.374414696 -0.022267903
## variable 12  4.534880e-02 -0.374381287 -0.013986121
## variable 13  6.385742e-02 -0.370055099 -0.031673499
## variable 14  3.111306e-02 -0.364729611 -0.002535536
## variable 15  1.288107e-05  0.006270320 -0.406011655
## variable 16  1.305259e-05  0.018689756 -0.407077598
## variable 17  1.211560e-05  0.009078483 -0.411159927
## variable 18  1.039548e-05  0.036022360 -0.398788351
## variable 19  1.331297e-05  0.005889322 -0.410538009
## variable 20  1.326763e-05  0.035028974 -0.412758321</code></pre>
<p>The matrix of the prior precisions can be called with</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">mod2<span class="op">$</span>Tau</a></code></pre></div>
<pre><code>##              Component 1 Component 2  Component 3
## variable 1  6.711653e+00  185.292815 30792.083009
## variable 2  6.811715e+00  435.456531 24282.641765
## variable 3  6.733579e+00  246.605678 24174.268760
## variable 4  6.906649e+00  137.269136 25240.818694
## variable 5  6.630610e+00  334.561356 25606.215195
## variable 6  6.535962e+00  151.540810 29303.191065
## variable 7  6.916642e+00  278.901798 29505.931801
## variable 8  2.000395e+02    6.283433   670.346568
## variable 9  2.297542e+02    6.662857   568.834746
## variable 10 4.206301e+02    6.647409  1984.202810
## variable 11 1.678142e+02    6.740676   596.809053
## variable 12 2.033657e+02    6.710938   964.165004
## variable 13 1.294742e+02    6.828244   390.109550
## variable 14 3.541861e+02    7.207997  5635.426286
## variable 15 3.077602e+05 2373.138268     5.837005
## variable 16 3.081676e+05  748.154670     5.771306
## variable 17 3.180735e+05 1556.626020     5.676298
## variable 18 3.115912e+05  349.915331     5.997557
## variable 19 3.116412e+05 2503.322335     5.710167
## variable 20 3.100489e+05  362.448139     5.591906</code></pre>
</div>
<div id="random-tau-gamma-prior" class="section level3">
<h3>Random <code>tau</code>: Gamma prior</h3>
<p>It is possible to specify a gamma prior on <span class="math inline">\(\tau_{d,j}\)</span>:</p>
<p><span class="math display">\[ \tau_{d,j} \sim G(\alpha, \beta) \]</span></p>
<p>with <span class="math inline">\(\alpha\)</span> shape parameter and <span class="math inline">\(\beta\)</span> scale parameter. The following code implements an IG(2, .5) prior on the precisions:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Estimate the model</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">mod3 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>,</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">              <span class="dt">alphatau =</span> <span class="dv">2</span>, <span class="dt">betatau =</span> <span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">              <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">              <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">              <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">mod3<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##              Component 1 Component 2   Component 3
## variable 1  -0.376590725 -0.04416826  0.0002947089
## variable 2  -0.373916478 -0.04580818 -0.0111139002
## variable 3  -0.375152260 -0.04306330 -0.0078485203
## variable 4  -0.374771451 -0.04473662 -0.0031287802
## variable 5  -0.376819149 -0.04285298 -0.0099904658
## variable 6  -0.375128188 -0.04445803 -0.0015201459
## variable 7  -0.375056611 -0.04365135 -0.0007401483
## variable 8   0.043918292 -0.37612390 -0.0195191684
## variable 9   0.044336996 -0.37380699 -0.0224249101
## variable 10  0.043215418 -0.37316141 -0.0162245050
## variable 11  0.043435548 -0.37309952 -0.0245960805
## variable 12  0.045416539 -0.37575273 -0.0200103648
## variable 13  0.045161055 -0.37621087 -0.0206044028
## variable 14  0.044603008 -0.37569186 -0.0144838955
## variable 15  0.002901159  0.02228837 -0.4056891063
## variable 16  0.003405260  0.02198287 -0.4068836504
## variable 17  0.003228832  0.02064976 -0.4107113982
## variable 18  0.002920806  0.02319222 -0.4056322666
## variable 19  0.002018556  0.02191743 -0.4087810436
## variable 20  0.001885825  0.02043591 -0.4078295957</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">mod3<span class="op">$</span>Tau</a></code></pre></div>
<pre><code>##             Component 1 Component 2 Component 3
## variable 1     4.349798    4.952591    4.962213
## variable 2     4.357381    4.951847    4.961554
## variable 3     4.349198    4.947077    4.955868
## variable 4     4.347326    4.942587    4.952373
## variable 5     4.346511    4.949795    4.958338
## variable 6     4.348754    4.945842    4.955514
## variable 7     4.353855    4.952447    4.961810
## variable 8     4.940550    4.341632    4.948114
## variable 9     4.944064    4.351079    4.951230
## variable 10    4.946698    4.354576    4.954566
## variable 11    4.941841    4.351048    4.948103
## variable 12    4.940429    4.343068    4.948542
## variable 13    4.934790    4.337277    4.942629
## variable 14    4.954153    4.353743    4.962926
## variable 15    4.964065    4.961664    4.266733
## variable 16    4.955381    4.953028    4.256713
## variable 17    4.956688    4.954630    4.246359
## variable 18    4.954427    4.951810    4.259675
## variable 19    4.962441    4.960082    4.256343
## variable 20    4.950618    4.948561    4.250325</code></pre>
<p><code>alphatau</code> and <code>betatau</code> can also be specified as <span class="math inline">\(D\)</span>-dimensional array, in which case the Gamma will have component-specific hyperparameters: <span class="math display">\[ \tau_{d,j} \sim G(\alpha_d, \beta_d) \]</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># Estimate the model</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">mod4 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">              <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">              <span class="dt">alphatau =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">50</span>, <span class="dv">3</span>), <span class="dt">betatau =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.01</span>, <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">              <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">              <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8">mod4<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##              Component 1  Component 2   Component 3
## variable 1  -0.378535069 -0.022550177  0.0025320655
## variable 2  -0.376010407 -0.021331002 -0.0088680201
## variable 3  -0.377058121 -0.022705524 -0.0057334841
## variable 4  -0.376765736 -0.022799099 -0.0008880582
## variable 5  -0.378711737 -0.022502952 -0.0078832752
## variable 6  -0.377093814 -0.019646614  0.0006966940
## variable 7  -0.376981673 -0.026435232  0.0014645273
## variable 8   0.021618521 -0.045787586 -0.0012802351
## variable 9   0.022165897 -0.050285073 -0.0042910494
## variable 10  0.021098823 -0.037934476  0.0018542188
## variable 11  0.021297952 -0.049321093 -0.0065615922
## variable 12  0.023138118 -0.049443570 -0.0017949202
## variable 13  0.022842413 -2.348222240 -0.0025229191
## variable 14  0.022345189 -0.049142867  0.0037198670
## variable 15  0.002992116  0.002091087 -0.4063507109
## variable 16  0.003475947 -0.001948958 -0.4074613372
## variable 17  0.003205251  0.009070114 -0.4112473691
## variable 18  0.003062334  0.006593144 -0.4063446402
## variable 19  0.002077795  0.003818705 -0.4093929706
## variable 20  0.001857368 -0.003947850 -0.4083201743</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">mod4<span class="op">$</span>Tau</a></code></pre></div>
<pre><code>##             Component 1 Component 2 Component 3
## variable 1     1.735068  4883.95439   0.3498320
## variable 2     1.737956  4896.56336   0.3498312
## variable 3     1.734465  4881.98803   0.3498046
## variable 4     1.733223  4881.05886   0.3497852
## variable 5     1.733528  4884.42780   0.3498147
## variable 6     1.734107  4913.05908   0.3498008
## variable 7     1.736710  4838.95652   0.3498308
## variable 8     1.974312  4527.17251   0.3497740
## variable 9     1.976205  4440.53154   0.3497924
## variable 10    1.977395  4665.76589   0.3498030
## variable 11    1.974916  4459.48648   0.3497789
## variable 12    1.974487  4457.06148   0.3497771
## variable 13    1.971541    18.24647   0.3497487
## variable 14    1.981271  4463.32575   0.3498394
## variable 15    1.982402  5007.31481   0.3469784
## variable 16    1.977961  5007.38609   0.3469217
## variable 17    1.978586  4988.06776   0.3468739
## variable 18    1.977499  4997.44534   0.3469332
## variable 19    1.981517  5004.88288   0.3469270
## variable 20    1.975535  5004.38616   0.3468870</code></pre>
</div>
<div id="global-prior-variances" class="section level3">
<h3>Global prior variances</h3>
<p>So far, the parameter <code>global.var</code> has always ben set to <code>FALSE</code>, implying <span class="math display">\[ w_{j,d} \sim N(0, \tau_{j,d}^{-1}). \]</span> Setting <code>global.var = TRUE</code> will modify this formulation, which will switch to <span class="math display">\[ w_{j,d} \sim N(0, \tau_{d}{-1}) \]</span> that is, component-specific variances (called ‘global variances’ in <code>vbpca</code>) will be estimated instead:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Fixed prior global variances, updated via Type-II maximum likelihood:</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">mod5 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">alphatau=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>,  </a>
<a class="sourceLine" id="cb24-4" data-line-number="4">              <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">              <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">              <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">global.var =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Prior precisions for the first 3 components." />
<p class="caption">Prior precisions for the first 3 components.</p>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">mod5<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##              Component 1 Component 2   Component 3
## variable 1  -0.376586376 -0.04416415  0.0003398288
## variable 2  -0.373936478 -0.04582247 -0.0111462062
## variable 3  -0.375145347 -0.04305764 -0.0078812377
## variable 4  -0.374766771 -0.04473003 -0.0031117254
## variable 5  -0.376804702 -0.04285698 -0.0100225924
## variable 6  -0.375110756 -0.04446232 -0.0015008417
## variable 7  -0.375066036 -0.04363986 -0.0007179364
## variable 8   0.043915686 -0.37609866 -0.0194939691
## variable 9   0.044338605 -0.37381876 -0.0224110177
## variable 10  0.043215857 -0.37318643 -0.0161925578
## variable 11  0.043432406 -0.37310277 -0.0246469635
## variable 12  0.045419757 -0.37573449 -0.0200022650
## variable 13  0.045157692 -0.37615576 -0.0206098658
## variable 14  0.044605257 -0.37570529 -0.0144801764
## variable 15  0.002905193  0.02229190 -0.4056457820
## variable 16  0.003409731  0.02199105 -0.4067877056
## variable 17  0.003232816  0.02063849 -0.4105979658
## variable 18  0.002919683  0.02319284 -0.4055783339
## variable 19  0.002019241  0.02192068 -0.4087014694
## variable 20  0.001874190  0.02043084 -0.4077300859</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">mod5<span class="op">$</span>Tau</a></code></pre></div>
<pre><code>## [1] 17.34676 17.34719 17.35455</code></pre>
<p>Notice the plot of the precisions that appears in this case. This is useful when the number of components supported by the data is uncertain (scree-plot - see Figure 2):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">mod6 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">10</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">alphatau=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>,  </a>
<a class="sourceLine" id="cb29-3" data-line-number="3">              <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">              <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">              <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">global.var =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Scree-plot for 10 components." />
<p class="caption">Scree-plot for 10 components.</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">mod6<span class="op">$</span>Tau</a></code></pre></div>
<pre><code>##  [1] 18.64014 18.64036 18.64422 19.91587 20.21201 20.37469 20.67901
##  [8] 20.87993 21.03862 21.22528</code></pre>
</div>
</div>
<div id="automatic-relevance-determination" class="section level2">
<h2>Automatic Relevance Determination</h2>
<p>When the prior precisions are updated, they can help to perform component-specific variable selection through Automatic Relevance Determination (ARD). In particular, values in the Tau matrix that are extremely large determine the values of the weights that can be set to 0. This is because their inverse (prior variances) are very close to 0, and thus making the elements of <span class="math inline">\(W\)</span> also close to 0 with high probability. We’re going to show an example here, with fixed (updated through Type-II maximum likelihood) precisions (in case of Gamma prior, it is recommended to use hyperparamter values close to 0).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">mod7 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">alphatau=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">center =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">              <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">              <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">              <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb32-6" data-line-number="6"></a>
<a class="sourceLine" id="cb32-7" data-line-number="7">mod7<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##               Component 1  Component 2  Component 3
## variable 1  -3.774720e-01 -0.051470102 -0.001822156
## variable 2  -3.744848e-01 -0.025307896 -0.002337156
## variable 3  -3.747070e-01 -0.039179989 -0.002345241
## variable 4  -3.697882e-01 -0.062258504 -0.002242303
## variable 5  -3.794353e-01 -0.031311390 -0.002225193
## variable 6  -3.811333e-01 -0.058594825 -0.001901847
## variable 7  -3.709497e-01 -0.037084346 -0.001895318
## variable 8   4.572526e-02 -0.388171353 -0.019796029
## variable 9   4.119102e-02 -0.376636645 -0.023267758
## variable 10  2.518537e-02 -0.376940208 -0.006967316
## variable 11  5.297341e-02 -0.374414696 -0.022267903
## variable 12  4.534880e-02 -0.374381287 -0.013986121
## variable 13  6.385742e-02 -0.370055099 -0.031673499
## variable 14  3.111306e-02 -0.364729611 -0.002535536
## variable 15  1.288107e-05  0.006270320 -0.406011655
## variable 16  1.305259e-05  0.018689756 -0.407077598
## variable 17  1.211560e-05  0.009078483 -0.411159927
## variable 18  1.039548e-05  0.036022360 -0.398788351
## variable 19  1.331297e-05  0.005889322 -0.410538009
## variable 20  1.326763e-05  0.035028974 -0.412758321</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">mod7<span class="op">$</span>Tau</a></code></pre></div>
<pre><code>##              Component 1 Component 2  Component 3
## variable 1  6.711653e+00  185.292815 30792.083009
## variable 2  6.811715e+00  435.456531 24282.641765
## variable 3  6.733579e+00  246.605678 24174.268760
## variable 4  6.906649e+00  137.269136 25240.818694
## variable 5  6.630610e+00  334.561356 25606.215195
## variable 6  6.535962e+00  151.540810 29303.191065
## variable 7  6.916642e+00  278.901798 29505.931801
## variable 8  2.000395e+02    6.283433   670.346568
## variable 9  2.297542e+02    6.662857   568.834746
## variable 10 4.206301e+02    6.647409  1984.202810
## variable 11 1.678142e+02    6.740676   596.809053
## variable 12 2.033657e+02    6.710938   964.165004
## variable 13 1.294742e+02    6.828244   390.109550
## variable 14 3.541861e+02    7.207997  5635.426286
## variable 15 3.077602e+05 2373.138268     5.837005
## variable 16 3.081676e+05  748.154670     5.771306
## variable 17 3.180735e+05 1556.626020     5.676298
## variable 18 3.115912e+05  349.915331     5.997557
## variable 19 3.116412e+05 2503.322335     5.710167
## variable 20 3.100489e+05  362.448139     5.591906</code></pre>
<p>We can also plot an heatmap of the resulting precision matrix; we set a threshold parameter (to establish when the precision elements are too large) equal to 50:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">mat_mod_<span class="dv">7</span> &lt;-<span class="st"> </span><span class="kw">plotheatmap</span>(mod7, <span class="dt">matrix_type=</span><span class="st">&quot;Tau&quot;</span>, <span class="dt">bound_tau=</span><span class="dv">50</span>)</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Heatmap of Tau." />
<p class="caption">Heatmap of Tau.</p>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">mat_mod_<span class="dv">7</span><span class="op">$</span>W</a></code></pre></div>
<pre><code>##             Component 1 Component 2 Component 3
## variable 1   -0.3774720   0.0000000   0.0000000
## variable 2   -0.3744848   0.0000000   0.0000000
## variable 3   -0.3747070   0.0000000   0.0000000
## variable 4   -0.3697882   0.0000000   0.0000000
## variable 5   -0.3794353   0.0000000   0.0000000
## variable 6   -0.3811333   0.0000000   0.0000000
## variable 7   -0.3709497   0.0000000   0.0000000
## variable 8    0.0000000  -0.3881714   0.0000000
## variable 9    0.0000000  -0.3766366   0.0000000
## variable 10   0.0000000  -0.3769402   0.0000000
## variable 11   0.0000000  -0.3744147   0.0000000
## variable 12   0.0000000  -0.3743813   0.0000000
## variable 13   0.0000000  -0.3700551   0.0000000
## variable 14   0.0000000  -0.3647296   0.0000000
## variable 15   0.0000000   0.0000000  -0.4060117
## variable 16   0.0000000   0.0000000  -0.4070776
## variable 17   0.0000000   0.0000000  -0.4111599
## variable 18   0.0000000   0.0000000  -0.3987884
## variable 19   0.0000000   0.0000000  -0.4105380
## variable 20   0.0000000   0.0000000  -0.4127583</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">mat_mod_<span class="dv">7</span><span class="op">$</span>Tau </a></code></pre></div>
<pre><code>##             Component 1 Component 2 Component 3
## variable 1     6.711653   50.000000   50.000000
## variable 2     6.811715   50.000000   50.000000
## variable 3     6.733579   50.000000   50.000000
## variable 4     6.906649   50.000000   50.000000
## variable 5     6.630610   50.000000   50.000000
## variable 6     6.535962   50.000000   50.000000
## variable 7     6.916642   50.000000   50.000000
## variable 8    50.000000    6.283433   50.000000
## variable 9    50.000000    6.662857   50.000000
## variable 10   50.000000    6.647409   50.000000
## variable 11   50.000000    6.740676   50.000000
## variable 12   50.000000    6.710938   50.000000
## variable 13   50.000000    6.828244   50.000000
## variable 14   50.000000    7.207997   50.000000
## variable 15   50.000000   50.000000    5.837005
## variable 16   50.000000   50.000000    5.771306
## variable 17   50.000000   50.000000    5.676298
## variable 18   50.000000   50.000000    5.997557
## variable 19   50.000000   50.000000    5.710167
## variable 20   50.000000   50.000000    5.591906</code></pre>
</div>
<div id="high-posterior-density-intervals" class="section level2">
<h2>High posterior density intervals</h2>
<p>It is also possible to require the computation of high probability density intervals for the elements of <span class="math inline">\(W\)</span>, which can then be plotted with the <code>plothpdi</code> function, which internally calls <code>ggplot2</code> functionalities. <em>Note</em>: when the weights are required in normalised form, the posterior density interval will still be returned in the original weights scale (thus, no normalisation is performed on the HPDIs).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># Set hyperparameter values and require 90% probability density intervals</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="co"># Estimate the model</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3">mod8 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>,</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">                <span class="dt">alphatau =</span> <span class="fl">.001</span>, <span class="dt">betatau =</span> <span class="fl">.001</span>,</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">                <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb41-6" data-line-number="6">                <span class="dt">hpdi =</span> <span class="ot">TRUE</span>, <span class="dt">probHPDI =</span> <span class="fl">0.9</span>,</a>
<a class="sourceLine" id="cb41-7" data-line-number="7">                <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb41-8" data-line-number="8">                <span class="dt">verbose =</span> <span class="ot">TRUE</span> )</a></code></pre></div>
<pre><code>## Local prior variances : Gamma.</code></pre>
<pre><code>## Iteration: 1 - ELBO: -3088.1
## Start # 1 has converged in 4 iterations; lower bound = -3077.58</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co"># Plot HPD intervals for variables 1:10, component 1</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="kw">plothpdi</span>(mod8, <span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">vars =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="High posterior density intervals." />
<p class="caption">High posterior density intervals.</p>
</div>
</div>
<div id="retrieve-principal-components" class="section level2">
<h2>Retrieve Principal Components</h2>
<p>To compute the estimated components, simpy call:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">PCs &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>mod1<span class="op">$</span>muW </a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">head</span>(PCs, <span class="dv">15</span>)</a></code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]   -59.19132  -78.592707  31.3401056
##  [2,]    28.97173 -118.789002 -29.0200803
##  [3,]   -11.00518   14.227039  -4.8429367
##  [4,]    92.16140  -33.606390 -28.1184509
##  [5,]   -41.61482 -212.440559  13.4800647
##  [6,]   113.51610  -20.107248   5.6778548
##  [7,]    98.45308  -73.892683  17.2711826
##  [8,]    42.05467 -142.922658 -68.0937551
##  [9,]   -57.38540  -66.586047  17.5396918
## [10,]    42.94090   51.286634  -0.2553017
## [11,]    36.39523  -11.871548  13.9383095
## [12,]   109.60474   -6.656482  25.3900580
## [13,]  -196.01791  110.020825  -9.5996919
## [14,]  -267.42318   71.336729  14.1676697
## [15,]    38.49334   22.034659 -32.6994089</code></pre>
<div id="references" class="section level3">
<h3>References</h3>
<ol style="list-style-type: decimal">
<li>C. M. Bishop. ‘Variational PCA’. In Proc. Ninth Int. Conf. on Artificial Neural Networks. ICANN, 1999.</li>
</ol>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
