<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Davide Vidotto d.vidotto@uvt.nl" />

<meta name="date" content="2019-06-03" />

<title>bayespca Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">bayespca Package</h1>
<h4 class="author">Davide Vidotto <a href="mailto:d.vidotto@uvt.nl">d.vidotto@uvt.nl</a></h4>
<h4 class="date">2019-06-03</h4>



<div id="bayespca-a-package-for-variational-bayes-pca" class="section level1">
<h1>bayespca: A package for Variational Bayes PCA</h1>
<div id="theoretical-background" class="section level2">
<h2>Theoretical background</h2>
<p>Principal Components Analysis (PCA) allows performing dimensionality reduction via matrix factorization. While there are several ways to express a PCA model, in what follows will we consider the formulation <span class="math display">\[ X = X W P^T + E, \]</span> where X is a <span class="math inline">\(I \times J\)</span> data matrix (<span class="math inline">\(I\)</span> is the number of units; <span class="math inline">\(J\)</span> the number of continuous variables); <span class="math inline">\(W\)</span> is a <span class="math inline">\(J \times D\)</span> weight matrix (<span class="math inline">\(D \leq J\)</span> is the rank of the reduced matrix); <span class="math inline">\(P\)</span> is the orthogonal loading matrix, such that <span class="math inline">\(P^T P = I_{D \times D}\)</span>; and <span class="math inline">\(E\)</span> is an <span class="math inline">\(I \times J\)</span> error matrix. The <span class="math inline">\(D\)</span> principal components can be retrieved with <span class="math inline">\(Z = X W\)</span>. In this context, the focus of the inference is typically on <span class="math inline">\(W\)</span>. In particular, when <span class="math inline">\(J\)</span> is large and the main inferential goal is components’ interpretation, it is important for the analyst to obtain simple and interpretable components.</p>
<p>The <code>bayespca</code> package allows performing the following operations:</p>
<ol style="list-style-type: decimal">
<li>estimation of the PCA model, with a Variational Bayes algorithm;<br />
</li>
<li>regularization of the elements of <span class="math inline">\(W\)</span> by means of its prior variances;</li>
<li>variable selection, via a Stochastic Search Variable Selection method (a form of “spike-and-slab” prior).</li>
</ol>
<p>The Variational Bayes algorithm sees the columns of <span class="math inline">\(W\)</span> as latent variables, and <span class="math inline">\(P\)</span> as a fixed parameter. Furthermore, the residuals <span class="math inline">\(E\)</span> are assumed to be distributed according to a Normal distribution with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>. The following prior is assumed for the <span class="math inline">\(d\)</span>-th column of <span class="math inline">\(W\)</span>:</p>
<p><span class="math display">\[ w_d \sim MVN(0, T_d)  \]</span></p>
<p>where <span class="math inline">\(MVN()\)</span> denotes the density of the Multivariate Normal Matrix, and T_d denotes the prior (diagonal) covariance matrix of the <span class="math inline">\(d\)</span>-th component. The <span class="math inline">\(j\)</span>-th element of the diagonal of <span class="math inline">\(T_d\)</span> will be denoted <span class="math inline">\(\tau_{dj}\)</span>.<br />
where <span class="math inline">\(MVN()\)</span> denotes the density of the Multivariate Normal Matrix, and T_d denotes the prior (diagonal) covariance matrix of the <span class="math inline">\(d\)</span>-th component. The <span class="math inline">\(j\)</span>-th element of the diagonal of <span class="math inline">\(T_d\)</span> will be denoted <span class="math inline">\(\tau_j\)</span>.</p>
</div>
<div id="the-bayespca-package" class="section level2">
<h2>The <code>bayespca</code> package</h2>
<p>Variational Bayes PCA is implemented through the <code>vbpca</code> function, which takes the following arguments as inputs:</p>
<ul>
<li><code>X</code> the input matrix;</li>
<li><code>D</code> the number of components to be estimated;</li>
<li><code>maxIter</code> the maximum number of iterations for the Variational Bayes algorithm;</li>
<li><code>tolerance</code> convergence criterion of the algorithm (relative difference between ELBO values);</li>
<li><code>verbose</code> logical parameter which prints estimation information on screen when <code>TRUE</code>;</li>
<li><code>tau</code> value of the prior variances; starting value when <code>updatetau=TRUE</code> or <code>priorvar!='fixed'</code></li>
<li><code>updatetau</code> logical parameter denoting whether the prior variances should be updated when <code>priorvar='fixed'</code>;</li>
<li><code>priorvar</code> character argument denoting whether the prior variances should be <code>'fixed'</code>, or random with <code>'jeffrey'</code> or <code>'invgamma'</code> priors;<br />
</li>
<li><code>SVS</code> logical argument which activates Stochastic Variable Selection when set to <code>TRUE</code>;</li>
<li><code>priorInclusion</code> prior inclusion probabilities for the elements of <span class="math inline">\(W\)</span> in the model;</li>
<li><code>global.var</code> logical parameter which activates component-specific prior variances when set to <code>TRUE</code>;</li>
<li><code>control</code> other control parameters, such as Inverse Gamma hyperparameters (see <code>?vbpca_control</code> for more information).</li>
</ul>
<p><code>vbpca</code> returns a vbpca object, which is a list containing various aspect of the model results. See <code>?vbpca</code> for further information. Internally, <code>vbpca</code> calls a C++ function (written with Rcpp) to estimate the model.</p>
<p>In what follows, the various estimation modalities allowed by <code>vbpca</code> will be introduced. For presentation purposes, a synthetic data matrix with <span class="math inline">\(I = 100\)</span> rows and <span class="math inline">\(J = 20\)</span> columns genereted from three components will be used:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">141</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">I &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">J &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">V1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">V2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">V3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(V1, <span class="dv">7</span>), <span class="kw">rep</span>(V2, <span class="dv">7</span>), <span class="kw">rep</span>(V3, <span class="dv">6</span>)), I, J)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">X &lt;-<span class="st"> </span>X <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(I <span class="op">*</span><span class="st"> </span>J, <span class="dv">0</span>, <span class="dv">1</span>), I, J)</a></code></pre></div>
<p>I will now proceed with the estimation of the PCA model.</p>
</div>
<div id="levels-of-regularization-on-the-w-matrix" class="section level2">
<h2>Levels of regularization on the W matrix</h2>
<div id="fixed-tau" class="section level3">
<h3>Fixed <code>tau</code></h3>
<p>With fixed tau, it is possible to specify the model as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Install and load package </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># devtools::install_github(&quot;davidevdt/bayespca&quot;)</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(bayespca)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># De-activate data center and scaling;</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">ctrl &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb2-8" data-line-number="8">                      <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co"># Estimate vbpca with fixed prior variances (equal to 1) </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># for the elements of W </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">mod1 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>, </a>
<a class="sourceLine" id="cb2-14" data-line-number="14">              <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co"># Test the class of mod1: </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="kw">is.vbpca</span>(mod1)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The estimate posterior means of the <span class="math inline">\(W\)</span> matrix can be viewed with:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">mod1<span class="op">$</span>muW </a></code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376589698 -0.04416511  0.0003399127
##  [2,] -0.373939776 -0.04582346 -0.0111489577
##  [3,] -0.375148656 -0.04305857 -0.0078831833
##  [4,] -0.374770076 -0.04473100 -0.0031124936
##  [5,] -0.376808025 -0.04285791 -0.0100250665
##  [6,] -0.375114064 -0.04446329 -0.0015012122
##  [7,] -0.375069345 -0.04364081 -0.0007181137
##  [8,]  0.043916073 -0.37610684 -0.0194987814
##  [9,]  0.044338996 -0.37382689 -0.0224165501
## [10,]  0.043216238 -0.37319455 -0.0161965551
## [11,]  0.043432789 -0.37311089 -0.0246530479
## [12,]  0.045420158 -0.37574266 -0.0200072027
## [13,]  0.045158091 -0.37616395 -0.0206149535
## [14,]  0.044605650 -0.37571347 -0.0144837510
## [15,]  0.002905219  0.02229238 -0.4057459196
## [16,]  0.003409761  0.02199152 -0.4068881251
## [17,]  0.003232844  0.02063894 -0.4106993259
## [18,]  0.002919709  0.02319335 -0.4056784549
## [19,]  0.002019259  0.02192116 -0.4088023613
## [20,]  0.001874207  0.02043128 -0.4078307380</code></pre>
<p>and the <span class="math inline">\(P\)</span> matrix:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">mod1<span class="op">$</span>P </a></code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376589904 -0.04416517  0.0003399179
##  [2,] -0.373939981 -0.04582353 -0.0111491289
##  [3,] -0.375148862 -0.04305863 -0.0078833043
##  [4,] -0.374770282 -0.04473106 -0.0031125414
##  [5,] -0.376808232 -0.04285797 -0.0100252205
##  [6,] -0.375114270 -0.04446335 -0.0015012352
##  [7,] -0.375069551 -0.04364087 -0.0007181247
##  [8,]  0.043916097 -0.37610735 -0.0194990808
##  [9,]  0.044339020 -0.37382740 -0.0224168943
## [10,]  0.043216262 -0.37319506 -0.0161968038
## [11,]  0.043432813 -0.37311139 -0.0246534264
## [12,]  0.045420183 -0.37574317 -0.0200075099
## [13,]  0.045158115 -0.37616446 -0.0206152700
## [14,]  0.044605675 -0.37571398 -0.0144839734
## [15,]  0.002905220  0.02229241 -0.4057521497
## [16,]  0.003409762  0.02199155 -0.4068943728
## [17,]  0.003232846  0.02063897 -0.4107056321
## [18,]  0.002919710  0.02319338 -0.4056846840
## [19,]  0.002019260  0.02192119 -0.4088086384
## [20,]  0.001874208  0.02043131 -0.4078370001</code></pre>
<p>Among other things, the function returns also the model evidence lower bound (ELBO) and the estimation time:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">mod1<span class="op">$</span>elbo </a></code></pre></div>
<pre><code>## [1] -2834.329</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">mod1<span class="op">$</span>time </a></code></pre></div>
<pre><code>##    user  system elapsed 
##       0       0       0</code></pre>
</div>
<div id="fixed-updatable-tau" class="section level3">
<h3>Fixed, updatable <code>tau</code></h3>
<p>The prior variances <span class="math inline">\(\tau_{dj}\)</span> can also be updated via Type-II Maximum Likelihood (empirical Bayes updates):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">mod2 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">mod2<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##         Component 1  Component 2  Component 3
##  [1,] -3.770417e-01 -0.051573499 -0.001788633
##  [2,] -3.747997e-01 -0.025120541 -0.002279085
##  [3,] -3.749896e-01 -0.039169668 -0.002284711
##  [4,] -3.695986e-01 -0.062446420 -0.002188222
##  [5,] -3.798267e-01 -0.031100065 -0.002172447
##  [6,] -3.809607e-01 -0.058646547 -0.001863930
##  [7,] -3.707615e-01 -0.037076450 -0.001858450
##  [8,]  4.610643e-02 -0.388243166 -0.019761887
##  [9,]  4.122547e-02 -0.376699340 -0.023207406
## [10,]  2.542203e-02 -0.376987920 -0.006935656
## [11,]  5.233439e-02 -0.374340987 -0.022206305
## [12,]  4.536997e-02 -0.374395905 -0.013879307
## [13,]  6.378896e-02 -0.370090650 -0.031591876
## [14,]  3.106493e-02 -0.364598986 -0.002519184
## [15,]  5.847012e-06  0.006198051 -0.406003865
## [16,]  6.041405e-06  0.018464891 -0.407039992
## [17,]  5.235991e-06  0.009013294 -0.411151002
## [18,]  3.518425e-06  0.036121023 -0.398782724
## [19,]  6.288835e-06  0.005824170 -0.410563013
## [20,]  6.214579e-06  0.034945874 -0.412808540</code></pre>
<p>The matrix of the inverse prior variances can be called with</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">mod2<span class="op">$</span>invTau</a></code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] 6.723601e+00  184.301093 31906.370474
##  [2,] 6.797876e+00  437.595911 25321.510591
##  [3,] 6.720477e+00  245.899700 25234.633828
##  [4,] 6.909797e+00  136.385519 26302.854238
##  [5,] 6.614756e+00  336.071862 26671.584534
##  [6,] 6.538464e+00  150.961175 30414.866197
##  [7,] 6.920149e+00  278.098093 30606.846239
##  [8,] 1.973803e+02    6.278101   670.761526
##  [9,] 2.288287e+02    6.657350   569.759379
## [10,] 4.149292e+02    6.642324  1989.950540
## [11,] 1.699204e+02    6.739745   597.851184
## [12,] 2.026152e+02    6.706750   970.392618
## [13,] 1.292935e+02    6.822902   390.944658
## [14,] 3.536290e+02    7.210202  5658.371089
## [15,] 3.158381e+05 2396.464633     5.835080
## [16,] 3.162767e+05  757.091273     5.769939
## [17,] 3.264009e+05 1565.810039     5.674352
## [18,] 3.196566e+05  348.615143     5.995065
## [19,] 3.198439e+05 2526.927990     5.707424
## [20,] 3.182544e+05  363.292431     5.588104</code></pre>
</div>
<div id="random-tau-jeffreys-prior" class="section level3">
<h3>Random <code>tau</code>: Jeffrey’s prior</h3>
<p>By assuming Jeffrey’s hyperpriors on <span class="math inline">\(\tau_{d,j}\)</span> we set:</p>
<p><span class="math display">\[ p(\tau_{d,j}) \propto \frac{1}{\tau_{d,j}}.  \]</span></p>
<p>The following code runs the algorithm with Jeffrey’s priors on <code>tau</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">mod3 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, </a>
<a class="sourceLine" id="cb16-2" data-line-number="2">              <span class="dt">priorvar =</span> <span class="st">'jeffrey'</span>, <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">              </a>
<a class="sourceLine" id="cb16-4" data-line-number="4">              </a>
<a class="sourceLine" id="cb16-5" data-line-number="5">mod3<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##         Component 1  Component 2  Component 3
##  [1,] -3.757646e-01 -0.051773159 -0.001684598
##  [2,] -3.756863e-01 -0.024773150 -0.002122048
##  [3,] -3.758101e-01 -0.039042545 -0.002125161
##  [4,] -3.692192e-01 -0.062594644 -0.002042117
##  [5,] -3.808786e-01 -0.030957878 -0.002028616
##  [6,] -3.802877e-01 -0.058870639 -0.001748039
##  [7,] -3.703552e-01 -0.036931472 -0.001746713
##  [8,]  4.721080e-02 -0.388387203 -0.019681028
##  [9,]  4.143813e-02 -0.376808913 -0.023157487
## [10,]  2.659771e-02 -0.377040717 -0.006727279
## [11,]  5.011560e-02 -0.374286630 -0.022163915
## [12,]  4.536128e-02 -0.374432238 -0.013520621
## [13,]  6.304093e-02 -0.370068016 -0.031431258
## [14,]  3.134111e-02 -0.364405737 -0.002414999
## [15,] -1.171811e-05  0.005936644 -0.406010842
## [16,] -1.146225e-05  0.018071121 -0.406913644
## [17,] -1.192092e-05  0.008654023 -0.411149650
## [18,] -1.359439e-05  0.036363148 -0.398751160
## [19,] -1.127322e-05  0.005569321 -0.410649936
## [20,] -1.140226e-05  0.034939861 -0.412915798</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">mod3<span class="op">$</span>invTau </a></code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] 6.767590e+00  183.413238 35792.389912
##  [2,] 6.767276e+00  444.807011 28717.737791
##  [3,] 6.692741e+00  246.914789 28653.864296
##  [4,] 6.923187e+00  135.973350 29770.336711
##  [5,] 6.579887e+00  337.917428 30166.978271
##  [6,] 6.560514e+00  150.229799 34271.225136
##  [7,] 6.934665e+00  279.497090 34407.243772
##  [8,] 1.915903e+02    6.273751   676.164203
##  [9,] 2.275212e+02    6.653730   573.008331
## [10,] 3.946490e+02    6.640583  2059.789146
## [11,] 1.794492e+02    6.741653   601.092050
## [12,] 2.026344e+02    6.705600  1000.451289
## [13,] 1.312116e+02    6.823768   394.628449
## [14,] 3.499053e+02    7.217607  5917.649066
## [15,] 3.510386e+05 2512.207936     5.834906
## [16,] 3.515804e+05  778.039952     5.773433
## [17,] 3.627243e+05 1637.770077     5.674439
## [18,] 3.549667e+05  347.219129     5.996028
## [19,] 3.555498e+05 2652.878686     5.705122
## [20,] 3.539059e+05  364.874639     5.585392</code></pre>
</div>
<div id="random-tau-inverse-gamma-prior" class="section level3">
<h3>Random <code>tau</code>: Inverse Gamma prior</h3>
<p>It is possible to specify an inverse gamma prior on <span class="math inline">\(\tau_{d,j}\)</span>:</p>
<p><span class="math display">\[ \tau_{d,j} \sim IG(\alpha, \beta) \]</span></p>
<p>with <span class="math inline">\(\alpha\)</span> shape parameter and <span class="math inline">\(\beta\)</span> scale parameter. The following code implements an IG(2, .5) prior on the variances:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># Set hyperparameter values </span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">ctrl2 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb20-4" data-line-number="4">                       <span class="dt">alphatau =</span> <span class="dv">2</span>, <span class="dt">betatau =</span> <span class="fl">.5</span>)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">                       </a>
<a class="sourceLine" id="cb20-6" data-line-number="6">                       </a>
<a class="sourceLine" id="cb20-7" data-line-number="7">                       </a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co"># Estimate the model </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9">mod4 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, </a>
<a class="sourceLine" id="cb20-10" data-line-number="10">              <span class="dt">control =</span> ctrl2, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb20-11" data-line-number="11">              </a>
<a class="sourceLine" id="cb20-12" data-line-number="12">              </a>
<a class="sourceLine" id="cb20-13" data-line-number="13">mod4<span class="op">$</span>muW </a></code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376590647 -0.04416831  0.0002942783
##  [2,] -0.373916145 -0.04580796 -0.0111136115
##  [3,] -0.375152370 -0.04306335 -0.0078482119
##  [4,] -0.374771589 -0.04473679 -0.0031289018
##  [5,] -0.376819230 -0.04285286 -0.0099901143
##  [6,] -0.375128398 -0.04445794 -0.0015202569
##  [7,] -0.375056419 -0.04365149 -0.0007404096
##  [8,]  0.043918311 -0.37612413 -0.0195192789
##  [9,]  0.044336971 -0.37380675 -0.0224249935
## [10,]  0.043215376 -0.37316095 -0.0162247651
## [11,]  0.043435543 -0.37309948 -0.0245954650
## [12,]  0.045416531 -0.37575287 -0.0200104086
## [13,]  0.045161134 -0.37621159 -0.0206043931
## [14,]  0.044602975 -0.37569136 -0.0144839228
## [15,]  0.002901088  0.02228831 -0.4056882953
## [16,]  0.003405222  0.02198276 -0.4068836318
## [17,]  0.003228802  0.02064986 -0.4107113728
## [18,]  0.002920826  0.02319232 -0.4056318015
## [19,]  0.002018519  0.02191736 -0.4087805942
## [20,]  0.001885975  0.02043594 -0.4078297610</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">mod4<span class="op">$</span>invTau</a></code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]    4.349513    4.952224    4.961845
##  [2,]    4.357094    4.951479    4.961185
##  [3,]    4.348866    4.946652    4.955442
##  [4,]    4.346970    4.942133    4.951918
##  [5,]    4.346201    4.949399    4.957941
##  [6,]    4.348419    4.945415    4.955085
##  [7,]    4.353566    4.952076    4.961437
##  [8,]    4.940075    4.341259    4.947637
##  [9,]    4.943619    4.350731    4.950784
## [10,]    4.946272    4.354243    4.954138
## [11,]    4.941374    4.350682    4.947635
## [12,]    4.939956    4.342697    4.948068
## [13,]    4.934268    4.336865    4.942105
## [14,]    4.953804    4.353473    4.962576
## [15,]    4.963713    4.961313    4.266473
## [16,]    4.954953    4.952599    4.256391
## [17,]    4.956272    4.954215    4.246050
## [18,]    4.953989    4.951371    4.259347
## [19,]    4.962076    4.959717    4.256072
## [20,]    4.950147    4.948089    4.249971</code></pre>
<p><code>alphatau</code> and <code>betatau</code> can also be specified as <span class="math inline">\(D\)</span>-dimensional array, in which case the Inverse Gamma will have component-specific hyperparameters: <span class="math display">\[ \tau_{d,j} \sim IG(\alpha_d, \beta_d) \]</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Set hyperparameter values </span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">ctrl3 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb24-4" data-line-number="4">                       <span class="dt">alphatau =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">50</span>, <span class="dv">3</span>), <span class="dt">betatau =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.01</span>, <span class="dv">10</span>), </a>
<a class="sourceLine" id="cb24-5" data-line-number="5">                       <span class="dt">hypertype =</span> <span class="st">'component'</span>)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">                       </a>
<a class="sourceLine" id="cb24-7" data-line-number="7">                       </a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co"># Estimate the model </span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9">mod5 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, </a>
<a class="sourceLine" id="cb24-10" data-line-number="10">              <span class="dt">control =</span> ctrl3, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb24-11" data-line-number="11"></a>
<a class="sourceLine" id="cb24-12" data-line-number="12">              </a>
<a class="sourceLine" id="cb24-13" data-line-number="13">mod5<span class="op">$</span>muW </a></code></pre></div>
<pre><code>##        Component 1  Component 2   Component 3
##  [1,] -0.378543478 -0.022403852  0.0025386295
##  [2,] -0.376019722 -0.021196983 -0.0088612115
##  [3,] -0.377066494 -0.022557126 -0.0057270031
##  [4,] -0.376774699 -0.022650241 -0.0008814042
##  [5,] -0.378720012 -0.022357681 -0.0078768015
##  [6,] -0.377102619 -0.019528818  0.0007032582
##  [7,] -0.376989874 -0.026248142  0.0014710887
##  [8,]  0.021470521 -0.045359009 -0.0012343390
##  [9,]  0.022018693 -0.049787441 -0.0042453561
## [10,]  0.020952041 -0.037610876  0.0018996414
## [11,]  0.021150966 -0.048838642 -0.0065159768
## [12,]  0.022990213 -0.048959831 -0.0017490218
## [13,]  0.022694280 -2.350959262 -0.0024775177
## [14,]  0.022197501 -0.048663411  0.0037657268
## [15,]  0.002988814  0.002048412 -0.4063509956
## [16,]  0.003472519 -0.001954198 -0.4074615231
## [17,]  0.003201167  0.008962963 -0.4112475488
## [18,]  0.003059452  0.006509927 -0.4063451138
## [19,]  0.002074293  0.003760222 -0.4093932228
## [20,]  0.001853458 -0.003935007 -0.4083201342</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">mod5<span class="op">$</span>invTau </a></code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]    1.734909  4885.51101   0.3498302
##  [2,]    1.737796  4897.91867   0.3498294
##  [3,]    1.734283  4883.57903   0.3498025
##  [4,]    1.733024  4882.65984   0.3497829
##  [5,]    1.733356  4885.97064   0.3498127
##  [6,]    1.733921  4914.16337   0.3497986
##  [7,]    1.736550  4841.25146   0.3498290
##  [8,]    1.974069  4535.17321   0.3497716
##  [9,]    1.975981  4450.34973   0.3497902
## [10,]    1.977182  4671.07826   0.3498009
## [11,]    1.974679  4468.90214   0.3497765
## [12,]    1.974249  4466.51594   0.3497748
## [13,]    1.971273    18.20417   0.3497460
## [14,]    1.981100  4472.66011   0.3498376
## [15,]    1.982219  5007.34354   0.3469767
## [16,]    1.977733  5007.36672   0.3469196
## [17,]    1.978365  4988.53185   0.3468718
## [18,]    1.977266  4997.70264   0.3469310
## [19,]    1.981324  5004.97797   0.3469253
## [20,]    1.975283  5004.39805   0.3468847</code></pre>
<p>Notice the different level of regularization obtained across the different components. In order to activate these ‘component-specific’ hyperpriors, <code>hypertype = 'component'</code> was specified.</p>
</div>
<div id="random-tau-random-betatau" class="section level3">
<h3>Random <code>tau</code>, random <code>betatau</code></h3>
<p>It is also possible to specify a Gamma hyperprior on <span class="math inline">\(\beta\)</span> (while <span class="math inline">\(\alpha\)</span> remains fixed): <span class="math display">\[ \beta \sim Ga(\gamma, \delta). \]</span> This is achievable by setting <code>gammatau</code> (and <code>deltatau</code>) larger than 0 in the control parameters:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Specify component-specific Gamma(.01, 10) hyperpriors on betatau </span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">ctrl4 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb28-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb28-4" data-line-number="4">                       <span class="dt">alphatau =</span> <span class="dv">1</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">                       <span class="dt">gammatau =</span> <span class="fl">.01</span>, <span class="dt">deltatau =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb28-6" data-line-number="6">                       <span class="dt">hypertype =</span> <span class="st">'component'</span>)</a>
<a class="sourceLine" id="cb28-7" data-line-number="7"></a>
<a class="sourceLine" id="cb28-8" data-line-number="8">                       </a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co"># Estimate the model </span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10">mod6 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, </a>
<a class="sourceLine" id="cb28-11" data-line-number="11">              <span class="dt">control =</span> ctrl4, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb28-12" data-line-number="12">              </a>
<a class="sourceLine" id="cb28-13" data-line-number="13">              </a>
<a class="sourceLine" id="cb28-14" data-line-number="14">mod6<span class="op">$</span>muW </a></code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376611437 -0.04414830 -0.001252671
##  [2,] -0.373522305 -0.04527018 -0.009487805
##  [3,] -0.375303126 -0.04330237 -0.006687095
##  [4,] -0.374545174 -0.04476030 -0.003779739
##  [5,] -0.377135323 -0.04290004 -0.008530456
##  [6,] -0.375471472 -0.04449079 -0.002519439
##  [7,] -0.374841518 -0.04378470 -0.001756540
##  [8,]  0.044091734 -0.37646021 -0.020075478
##  [9,]  0.044279171 -0.37340282 -0.022181983
## [10,]  0.043230863 -0.37275698 -0.017353060
## [11,]  0.043633682 -0.37285414 -0.022657108
## [12,]  0.045225592 -0.37597481 -0.020153766
## [13,]  0.045217385 -0.37690958 -0.020321214
## [14,]  0.044311525 -0.37546975 -0.014960798
## [15,]  0.002829728  0.02204140 -0.405116611
## [16,]  0.003208895  0.02187057 -0.407344521
## [17,]  0.003155312  0.02095411 -0.410909109
## [18,]  0.002824576  0.02288662 -0.405229626
## [19,]  0.002136107  0.02174443 -0.408747297
## [20,]  0.002177548  0.02077097 -0.407952211</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">mod6<span class="op">$</span>invTau </a></code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]    14.89847    49.95597    64.79114
##  [2,]    15.06380    49.85157    64.48104
##  [3,]    14.87935    49.45351    63.73992
##  [4,]    14.89953    49.19672    63.74737
##  [5,]    14.83146    49.84022    64.32954
##  [6,]    14.87624    49.45017    63.91513
##  [7,]    14.97986    49.94842    64.56200
##  [8,]    48.95314    14.77489    62.76748
##  [9,]    49.16960    14.97374    62.96668
## [10,]    49.41724    15.02556    63.45826
## [11,]    49.04970    14.98706    62.69018
## [12,]    48.92027    14.79264    62.77075
## [13,]    48.53974    14.68576    62.16584
## [14,]    50.07132    15.00763    64.71429
## [15,]    51.73889    51.41043    14.14011
## [16,]    51.12230    50.69433    13.94199
## [17,]    51.27494    50.94174    13.77126
## [18,]    51.01890    50.58728    14.03940
## [19,]    51.71281    51.34808    13.93690
## [20,]    50.73849    50.38297    13.85877</code></pre>
<p>The posterior means of <span class="math inline">\(\beta\)</span> can be accessed via</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">mod6<span class="op">$</span>priorBeta </a></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]
## [1,] 0.02643281 0.02638618 0.02076472
## attr(,&quot;names&quot;)
## [1] &quot;beta 1&quot; &quot;beta 2&quot; &quot;beta 3&quot;</code></pre>
<p><code>hypertype</code> specify the type of hyperprior for <code>beta</code>:</p>
<ul>
<li><code>'common'</code> implies <span class="math inline">\(\beta \sim Ga(\alpha, \beta)\)</span>;</li>
<li><code>'component'</code> implies <span class="math inline">\(\beta_d \sim Ga(\alpha_d, \beta_d)\)</span>;</li>
<li><code>'local'</code> implies <span class="math inline">\(\beta_{dj} \sim Ga(\alpha_{dj}, \beta_{dj})\)</span>.</li>
</ul>
<p>Similar to <code>alphatau</code> and <code>betatau</code>, <code>gammatau</code> and <code>deltatau</code> can also be <span class="math inline">\(D\)</span>-dimensional arrays for component-specific hyperpriors on <span class="math inline">\(\beta\)</span>.</p>
</div>
<div id="global-prior-variances" class="section level3">
<h3>Global prior variances</h3>
<p>So far, the parameter <code>global.var</code> has always ben set to <code>FALSE</code>, implying <span class="math display">\[ w_{j,d} \sim N(0, \tau_{j,d}). \]</span> Setting <code>global.var = TRUE</code> will modify this formulation, which will switch to <span class="math display">\[ w_{j,d} \sim N(0, \tau_{d}) \]</span> that is, component-specific variances (called ‘global variances’ in <code>vbpca</code>) will be estimated instead:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># Fixed prior global variances, updated via Type-II maximum likelihood: </span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2">mod7 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>,</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb34-4" data-line-number="4">              <span class="dt">global.var =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Prior variances for the first 3 components." />
<p class="caption">Prior variances for the first 3 components.</p>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">mod7<span class="op">$</span>muW </a></code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376586344 -0.04416414  0.0003398280
##  [2,] -0.373936445 -0.04582246 -0.0111461792
##  [3,] -0.375145315 -0.04305763 -0.0078812187
##  [4,] -0.374766738 -0.04473002 -0.0031117179
##  [5,] -0.376804669 -0.04285697 -0.0100225682
##  [6,] -0.375110723 -0.04446231 -0.0015008380
##  [7,] -0.375066004 -0.04363985 -0.0007179347
##  [8,]  0.043915682 -0.37609858 -0.0194939220
##  [9,]  0.044338601 -0.37381868 -0.0224109636
## [10,]  0.043215853 -0.37318635 -0.0161925187
## [11,]  0.043432402 -0.37310269 -0.0246469040
## [12,]  0.045419753 -0.37573441 -0.0200022167
## [13,]  0.045157688 -0.37615568 -0.0206098160
## [14,]  0.044605253 -0.37570521 -0.0144801414
## [15,]  0.002905193  0.02229189 -0.4056448021
## [16,]  0.003409730  0.02199104 -0.4067867230
## [17,]  0.003232816  0.02063848 -0.4105969740
## [18,]  0.002919683  0.02319284 -0.4055773542
## [19,]  0.002019241  0.02192068 -0.4087004821
## [20,]  0.001874190  0.02043083 -0.4077291009</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">mod7<span class="op">$</span>invTau </a></code></pre></div>
<pre><code>## [1] 17.32691 17.32734 17.33475</code></pre>
<p>Notice the plot of the prior variances (inverse precisions) that appears in this case. This is useful when the number of components supported by the data is uncertain (elbow method):</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">mod8 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">10</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>,</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">global.var =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb39-3" data-line-number="3">              <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Prior variances for 10 components." />
<p class="caption">Prior variances for 10 components.</p>
</div>
</div>
</div>
<div id="stochastic-search-variable-selection" class="section level2">
<h2>Stochastic Search Variable Selection</h2>
<p>By requiring <code>SVS = TRUE</code>, the model activates stochastic-search-variable-selection, a method described by George ad McCulloch (1993) for the Gibbs Sampler. The method has been adapted in <em>bayespca</em> for the Variational Bayes algorithm. The assumed ‘spike-and-slab’ prior for the <span class="math inline">\((j,d)\)</span>-th element of <span class="math inline">\(W\)</span> becomes:</p>
<p><span class="math display">\[ w_{j,d} \sim N(0, \pi \tau + (1 - \pi) \tau v_0)  \]</span></p>
<p>where <span class="math inline">\(v_0\)</span> is a scalar which rescales the spike variance to a value close to 0. For this reason, <span class="math inline">\(v_0\)</span> should be a number included in <span class="math inline">\((0, 1)\)</span>, as close as possible to 0. <span class="math inline">\(\pi\)</span> represents the prior probability of inclusion of the <span class="math inline">\(j\)</span>-th variable in the <span class="math inline">\(d\)</span>-th component of the model. <code>vbpca</code> estimates the posterior probabilities of inclusion, conditional on <span class="math inline">\(X\)</span> and the values in <span class="math inline">\(W\)</span>.</p>
<p>While <span class="math inline">\(v_0\)</span> should be a small value close to 0, too small values of such parameter will shrink the variances <span class="math inline">\(\tau\)</span> too much, and no variable will eventually be included in the model. On the other hand, using a too large value for <span class="math inline">\(v_0\)</span> will not shrink the variances enough, and all posterior inclusion probabilities will be close to 1. <span class="math inline">\(v_0\)</span> should then be set with a grain of salt. Preliminary results from partial simulation studies have shown that values between 0.0001 and 0.005 lead to acceptable results, but adequate values of <span class="math inline">\(v_0\)</span> can be dataset-specific. Preliminary simulation studies have also shown that the method works better when Inverse Gamma priors are specified for <span class="math inline">\(\tau\)</span>, with <code>betatau</code> equal to 1 and larger values of <code>alphatau</code>. However, the technique has just been devised and further studies must be carried out to further test the functioning of Stochastic Variable Selection in this context.</p>
<p>In <code>vbpca</code>, the parameter <span class="math inline">\(v_0\)</span> is called <code>v0</code> in the control parameters of <code>vbpca_control</code>, while the prior inclusion probability is called <code>priorInclusion</code>. <code>priorInclusion</code> can be fixed, updated via Type-II maximum likelihood, or assigned to a Beta hyperprior:</p>
<ul>
<li>among the control parameters of <code>vbpca_control</code>, set <code>beta1pi</code> smaller than 0 for fixed <span class="math inline">\(\pi\)</span>;</li>
<li>set <code>beta1pi = 0</code> instead for Type-II ML updates;</li>
<li>last, set <code>beta1pi</code> larger than 0 for Beta specifications.</li>
</ul>
<p>When <code>beta1pi</code> is larger than 0, a Beta prior is assumed for <span class="math inline">\(\pi\)</span>:</p>
<p><span class="math display">\[ \pi \sim Beta(\beta_1, \beta_2).\]</span></p>
<p>In <code>vbpca</code>, <span class="math inline">\(\beta1\)</span> can be controlled with the <code>beta1pi</code> argument and <span class="math inline">\(\beta2\)</span> with the <code>beta2pi</code> argument in <code>vbpca_control</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># SVS, fixed priorInclusion and InverseGamma(5, 1) for tau, v0 = .005</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">ctrl5 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb40-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb40-4" data-line-number="4">                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">                       <span class="dt">beta1pi =</span> <span class="dv">-1</span>, <span class="dt">v0 =</span> <span class="fl">5e-03</span>)</a>
<a class="sourceLine" id="cb40-6" data-line-number="6"></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="co"># Estimate the model with priorInclusion = 0.5</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8">mod9 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>,</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">              <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">priorInclusion =</span> <span class="fl">0.5</span>, <span class="dt">control =</span> ctrl5,</a>
<a class="sourceLine" id="cb40-10" data-line-number="10">              <span class="dt">verbose =</span> <span class="ot">FALSE</span> )                    </a>
<a class="sourceLine" id="cb40-11" data-line-number="11"></a>
<a class="sourceLine" id="cb40-12" data-line-number="12">mod9<span class="op">$</span>muW </a></code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376750692 -0.04448495 -0.004123683
##  [2,] -0.372459887 -0.04361185 -0.005752993
##  [3,] -0.375671975 -0.04356723 -0.004989270
##  [4,] -0.373836916 -0.04448097 -0.004703139
##  [5,] -0.377543656 -0.04319604 -0.005454948
##  [6,] -0.375846023 -0.04472475 -0.004528453
##  [7,] -0.375420482 -0.04399690 -0.004254785
##  [8,]  0.044408056 -0.37704714 -0.019871878
##  [9,]  0.043996739 -0.37297274 -0.020136604
## [10,]  0.043266209 -0.37568704 -0.019144528
## [11,]  0.043855992 -0.37127741 -0.019779142
## [12,]  0.044744851 -0.37518584 -0.019753061
## [13,]  0.045169754 -0.37455442 -0.019722877
## [14,]  0.043743494 -0.37734332 -0.018263649
## [15,]  0.002622365  0.02125415 -0.405655204
## [16,]  0.002687542  0.02139614 -0.407985339
## [17,]  0.002847711  0.02135195 -0.409082736
## [18,]  0.002536920  0.02132424 -0.406350545
## [19,]  0.002543555  0.02126640 -0.408688107
## [20,]  0.002678762  0.02114151 -0.408155324</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># SVS, priorInclusion update via Type-II ML and InverseGamma(5, 1) for tau, v0 = .005</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">ctrl6 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb42-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb42-4" data-line-number="4">                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">                       <span class="dt">beta1pi =</span> <span class="dv">0</span>, <span class="dt">v0 =</span> <span class="fl">5e-03</span>)</a>
<a class="sourceLine" id="cb42-6" data-line-number="6"></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="co"># Estimate the model </span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9">mod10 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>,</a>
<a class="sourceLine" id="cb42-10" data-line-number="10">               <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">control =</span> ctrl6, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb42-11" data-line-number="11"></a>
<a class="sourceLine" id="cb42-12" data-line-number="12">mod10<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376822858 -0.04443304 -0.004110117
##  [2,] -0.372325895 -0.04358556 -0.005696672
##  [3,] -0.375719676 -0.04343733 -0.004947834
##  [4,] -0.373891994 -0.04417952 -0.004672995
##  [5,] -0.377499434 -0.04330105 -0.005404333
##  [6,] -0.375807989 -0.04447934 -0.004504553
##  [7,] -0.375545922 -0.04396995 -0.004237517
##  [8,]  0.044270327 -0.37708845 -0.019689948
##  [9,]  0.043950486 -0.37294924 -0.019941341
## [10,]  0.043388634 -0.37576275 -0.018993761
## [11,]  0.043790469 -0.37125593 -0.019593898
## [12,]  0.044483556 -0.37516369 -0.019574536
## [13,]  0.044624502 -0.37452245 -0.019541209
## [14,]  0.043971197 -0.37746934 -0.018159259
## [15,]  0.002607960  0.02107537 -0.405654575
## [16,]  0.002664143  0.02120185 -0.407997814
## [17,]  0.002842471  0.02116014 -0.409084282
## [18,]  0.002533579  0.02111624 -0.406361382
## [19,]  0.002532490  0.02108300 -0.408694793
## [20,]  0.002668127  0.02094020 -0.408183022</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co"># SVS, priorInclusion with Beta(1,1) priors and InverseGamma(5, 1) for tau, v0 = .005</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2">ctrl7 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, <span class="dt">alphatau =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">                       <span class="dt">betatau =</span> <span class="dv">1</span>, <span class="dt">beta1pi =</span> <span class="dv">1</span>, <span class="dt">beta2pi =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb44-5" data-line-number="5">                       <span class="dt">v0 =</span> <span class="fl">1e-03</span>)</a>
<a class="sourceLine" id="cb44-6" data-line-number="6"></a>
<a class="sourceLine" id="cb44-7" data-line-number="7">                       </a>
<a class="sourceLine" id="cb44-8" data-line-number="8"><span class="co"># Estimate the model</span></a>
<a class="sourceLine" id="cb44-9" data-line-number="9">mod11 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, </a>
<a class="sourceLine" id="cb44-10" data-line-number="10">              <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">priorInclusion =</span> <span class="fl">0.5</span>, <span class="dt">control =</span> ctrl7,</a>
<a class="sourceLine" id="cb44-11" data-line-number="11">              <span class="dt">verbose =</span> <span class="ot">FALSE</span> ) </a>
<a class="sourceLine" id="cb44-12" data-line-number="12"></a>
<a class="sourceLine" id="cb44-13" data-line-number="13">              </a>
<a class="sourceLine" id="cb44-14" data-line-number="14">mod11<span class="op">$</span>muW             </a></code></pre></div>
<pre><code>##        Component 1  Component 2  Component 3
##  [1,] -0.377585969 -0.047939333 -0.002001648
##  [2,] -0.373162862 -0.042487944 -0.002374892
##  [3,] -0.374424310 -0.040392824 -0.002183428
##  [4,] -0.375075559 -0.046537326 -0.002133489
##  [5,] -0.376001850 -0.039418960 -0.002301476
##  [6,] -0.375864889 -0.047130795 -0.002098348
##  [7,] -0.375409214 -0.045695502 -0.002031570
##  [8,]  0.043401229 -0.378488759 -0.006154046
##  [9,]  0.044375834 -0.373875543 -0.006198091
## [10,]  0.042239525 -0.377115242 -0.005992542
## [11,]  0.044761079 -0.368634823 -0.006106240
## [12,]  0.044958241 -0.376871710 -0.006118384
## [13,]  0.045641060 -0.375075551 -0.006110655
## [14,]  0.044348933 -0.377244104 -0.005812578
## [15,]  0.001435196  0.006309373 -0.405990765
## [16,]  0.001444623  0.006308304 -0.408536058
## [17,]  0.001463239  0.006364100 -0.409391471
## [18,]  0.001438362  0.006326944 -0.406792705
## [19,]  0.001422580  0.006352733 -0.409223547
## [20,]  0.001425179  0.006319707 -0.409095996</code></pre>
<p>The estimated posterior inclusion probabilities for the three models:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">mod9<span class="op">$</span>inclusionProbabilities</a></code></pre></div>
<pre><code>##             [,1]      [,2]       [,3]
##  [1,] 1.00000000 0.2120296 0.09726907
##  [2,] 1.00000000 0.2068326 0.09851144
##  [3,] 1.00000000 0.2084065 0.09897047
##  [4,] 1.00000000 0.2139049 0.09843787
##  [5,] 1.00000000 0.2044355 0.09823061
##  [6,] 1.00000000 0.2146309 0.09848977
##  [7,] 1.00000000 0.2091004 0.09793821
##  [8,] 0.21428441 1.0000000 0.11723947
##  [9,] 0.21111001 1.0000000 0.11752795
## [10,] 0.20612101 1.0000000 0.11542999
## [11,] 0.21070545 1.0000000 0.11707616
## [12,] 0.21594418 1.0000000 0.11702863
## [13,] 0.21982827 1.0000000 0.11758358
## [14,] 0.20661409 1.0000000 0.11227938
## [15,] 0.09660274 0.1179197 1.00000000
## [16,] 0.09702372 0.1193704 1.00000000
## [17,] 0.09668529 0.1185038 1.00000000
## [18,] 0.09705420 0.1192275 1.00000000
## [19,] 0.09635180 0.1178253 1.00000000
## [20,] 0.09741905 0.1191173 1.00000000</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">mod10<span class="op">$</span>inclusionProbabilities</a></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
##  [1,] 1.00000000 0.14604123 0.06595144
##  [2,] 1.00000000 0.14241876 0.06677927
##  [3,] 1.00000000 0.14288168 0.06707145
##  [4,] 1.00000000 0.14595656 0.06672092
##  [5,] 1.00000000 0.14130427 0.06659022
##  [6,] 1.00000000 0.14681895 0.06675491
##  [7,] 1.00000000 0.14405489 0.06639296
##  [8,] 0.14694535 1.00000000 0.07949594
##  [9,] 0.14519685 1.00000000 0.07968820
## [10,] 0.14248443 1.00000000 0.07830934
## [11,] 0.14478837 1.00000000 0.07938071
## [12,] 0.14753285 1.00000000 0.07935458
## [13,] 0.14873386 1.00000000 0.07970621
## [14,] 0.14356166 1.00000000 0.07625060
## [15,] 0.06548873 0.08003940 1.00000000
## [16,] 0.06576005 0.08097049 1.00000000
## [17,] 0.06553993 0.08040118 1.00000000
## [18,] 0.06578191 0.08085128 1.00000000
## [19,] 0.06532184 0.07996842 1.00000000
## [20,] 0.06601984 0.08076926 1.00000000</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">mod11<span class="op">$</span>inclusionProbabilities</a></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
##  [1,] 1.00000000 1.00000000 0.06864236
##  [2,] 1.00000000 1.00000000 0.06905001
##  [3,] 1.00000000 1.00000000 0.06903261
##  [4,] 1.00000000 1.00000000 0.06892463
##  [5,] 1.00000000 1.00000000 0.06891797
##  [6,] 1.00000000 1.00000000 0.06892288
##  [7,] 1.00000000 1.00000000 0.06880774
##  [8,] 1.00000000 1.00000000 0.07471343
##  [9,] 1.00000000 1.00000000 0.07480727
## [10,] 1.00000000 1.00000000 0.07439398
## [11,] 1.00000000 1.00000000 0.07467890
## [12,] 1.00000000 1.00000000 0.07465084
## [13,] 1.00000000 1.00000000 0.07471088
## [14,] 1.00000000 1.00000000 0.07374679
## [15,] 0.06814353 0.07456737 1.00000000
## [16,] 0.06827512 0.07470610 1.00000000
## [17,] 0.06806801 0.07459243 1.00000000
## [18,] 0.06826865 0.07474289 1.00000000
## [19,] 0.06804514 0.07456130 1.00000000
## [20,] 0.06823635 0.07470003 1.00000000</code></pre>
<p>It is also possible to compare the (known) variable inclusion matrix vs. the estimated ones graphically. Let’s plot a heatmap of such probabilities for model <code>mod9</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">trueInclusions &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, J, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">trueInclusions[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">trueInclusions[<span class="dv">8</span><span class="op">:</span><span class="dv">14</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb52-4" data-line-number="4">trueInclusions[<span class="dv">15</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb52-5" data-line-number="5"></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="kw">image</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(trueInclusions), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(trueInclusions),  </a>
<a class="sourceLine" id="cb52-8" data-line-number="8">      <span class="kw">t</span>(trueInclusions[J<span class="op">:</span><span class="dv">1</span>, ]), <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb52-9" data-line-number="9">      <span class="dt">main =</span> <span class="st">&quot;True Inclusions&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb52-10" data-line-number="10">      <span class="dt">col =</span>  RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Blues&quot;</span>))</a>
<a class="sourceLine" id="cb52-11" data-line-number="11"><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">&quot;Component &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> ))      </a>
<a class="sourceLine" id="cb52-12" data-line-number="12"><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">&quot;Var &quot;</span>, J<span class="op">:</span><span class="dv">1</span> )) </a>
<a class="sourceLine" id="cb52-13" data-line-number="13"></a>
<a class="sourceLine" id="cb52-14" data-line-number="14">fields<span class="op">::</span><span class="kw">image.plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(trueInclusions), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(trueInclusions),  </a>
<a class="sourceLine" id="cb52-15" data-line-number="15">      <span class="kw">t</span>(mod9<span class="op">$</span>inclusionProbabilities[J<span class="op">:</span><span class="dv">1</span>, ]), <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb52-16" data-line-number="16">      <span class="dt">main =</span> <span class="st">&quot;Estimated Inclusions&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb52-17" data-line-number="17">      <span class="dt">col =</span> RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Blues&quot;</span>))  </a>
<a class="sourceLine" id="cb52-18" data-line-number="18"><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">&quot;Component &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> ))          </a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="True and Estimated inclusion probabilities." />
<p class="caption">True and Estimated inclusion probabilities.</p>
</div>
<p>For <code>mod10</code> and <code>mod11</code> we can observe the estimated prior inclusion probabilities:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">mod10<span class="op">$</span>priorInclusion</a></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.3987346
## [2,] 0.3987346
## [3,] 0.3987346</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">mod11<span class="op">$</span>priorInclusion</a></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.5945308
## [2,] 0.5945308
## [3,] 0.5945308</code></pre>
<p>Similar to the hyperparameters of the Inverse Gamma priors on <span class="math inline">\(\tau\)</span>, <code>priorInclusion</code>, <code>beta1pi</code> and <code>beta2pi</code>can also be specified as <span class="math inline">\(D\)</span>-dimensional arrays. This will allow estimating the inclusion probabilities with different degrees of ‘sparsity’ for each component. For Type-II maximum likelihood updates of <code>priorInclusion</code>, all elements of <code>beta1pi</code> must be equal to 0. For Beta priors, all elements of <code>beta1pi</code> must be larger than 0. Let us look at two examples:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co"># Type-II maximum likelihood (component-specific) updates </span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2">ctrl8 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb57-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb57-4" data-line-number="4">                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb57-5" data-line-number="5">                       <span class="dt">beta1pi =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">v0 =</span> <span class="fl">5e-03</span>)</a>
<a class="sourceLine" id="cb57-6" data-line-number="6"></a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="co"># Estimate the model </span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8">mod12 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, </a>
<a class="sourceLine" id="cb57-9" data-line-number="9">               <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">priorInclusion =</span> <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb57-10" data-line-number="10">               <span class="dt">control =</span> ctrl8, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb57-11" data-line-number="11"></a>
<a class="sourceLine" id="cb57-12" data-line-number="12"></a>
<a class="sourceLine" id="cb57-13" data-line-number="13">mod12<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376817775 -0.04443026 -0.004110336
##  [2,] -0.372360508 -0.04355404 -0.005678225
##  [3,] -0.375711830 -0.04340495 -0.004935813
##  [4,] -0.373900042 -0.04418527 -0.004666015
##  [5,] -0.377497008 -0.04324630 -0.005388196
##  [6,] -0.375809312 -0.04449066 -0.004500207
##  [7,] -0.375532827 -0.04394650 -0.004236029
##  [8,]  0.044261824 -0.37708496 -0.019640556
##  [9,]  0.043929313 -0.37297274 -0.019886136
## [10,]  0.043342443 -0.37573263 -0.018956990
## [11,]  0.043766769 -0.37127627 -0.019542974
## [12,]  0.044481053 -0.37518476 -0.019526532
## [13,]  0.044636397 -0.37455303 -0.019492259
## [14,]  0.043931728 -0.37743803 -0.018141983
## [15,]  0.002607056  0.02102946 -0.405651922
## [16,]  0.002663824  0.02115916 -0.408001417
## [17,]  0.002840070  0.02111391 -0.409084633
## [18,]  0.002532502  0.02107713 -0.406361999
## [19,]  0.002530700  0.02103708 -0.408695945
## [20,]  0.002665014  0.02089807 -0.408194788</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">mod12<span class="op">$</span>priorInclusion</a></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.4294635
## [2,] 0.4359775
## [3,] 0.3399416</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">mod12<span class="op">$</span>inclusionProbabilities </a></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
##  [1,] 1.00000000 0.16810342 0.05171407
##  [2,] 1.00000000 0.16382116 0.05235869
##  [3,] 1.00000000 0.16439404 0.05258104
##  [4,] 1.00000000 0.16809442 0.05230977
##  [5,] 1.00000000 0.16244473 0.05221079
##  [6,] 1.00000000 0.16908934 0.05233593
##  [7,] 1.00000000 0.16573007 0.05205611
##  [8,] 0.16509191 1.00000000 0.06237005
##  [9,] 0.16306252 1.00000000 0.06251995
## [10,] 0.15990420 1.00000000 0.06145088
## [11,] 0.16260305 1.00000000 0.06227781
## [12,] 0.16576567 1.00000000 0.06225943
## [13,] 0.16719978 1.00000000 0.06252745
## [14,] 0.16109063 1.00000000 0.05986055
## [15,] 0.07390531 0.09243547 1.00000000
## [16,] 0.07421527 0.09352661 1.00000000
## [17,] 0.07396456 0.09285742 1.00000000
## [18,] 0.07424059 0.09339617 1.00000000
## [19,] 0.07371601 0.09235335 1.00000000
## [20,] 0.07451101 0.09330382 1.00000000</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="co"># Beta priors with different degrees of sparsity for each component </span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2">ctrl9 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb63-3" data-line-number="3">                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb63-4" data-line-number="4">                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb63-5" data-line-number="5">                       <span class="dt">beta1pi =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">beta2pi =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb63-6" data-line-number="6">                       <span class="dt">v0 =</span> <span class="fl">5e-03</span>)</a>
<a class="sourceLine" id="cb63-7" data-line-number="7"></a>
<a class="sourceLine" id="cb63-8" data-line-number="8">                       </a>
<a class="sourceLine" id="cb63-9" data-line-number="9"><span class="co"># Estimate the model</span></a>
<a class="sourceLine" id="cb63-10" data-line-number="10">mod13 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, <span class="dt">SVS =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb63-11" data-line-number="11">              <span class="dt">priorInclusion =</span> <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">3</span>), <span class="dt">control =</span> ctrl9, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )  </a>
<a class="sourceLine" id="cb63-12" data-line-number="12"></a>
<a class="sourceLine" id="cb63-13" data-line-number="13">mod13<span class="op">$</span>muW</a></code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376823553 -0.04445292 -0.004069605
##  [2,] -0.372321780 -0.04356864 -0.005750480
##  [3,] -0.375720588 -0.04342350 -0.004970829
##  [4,] -0.373891258 -0.04421414 -0.004669279
##  [5,] -0.377499571 -0.04325604 -0.005447522
##  [6,] -0.375807748 -0.04451895 -0.004487080
##  [7,] -0.375547731 -0.04396570 -0.004205898
##  [8,]  0.044271252 -0.37708007 -0.019742308
##  [9,]  0.043952908 -0.37296691 -0.020024420
## [10,]  0.043394060 -0.37573006 -0.018982397
## [11,]  0.043792974 -0.37126432 -0.019656898
## [12,]  0.044483312 -0.37518104 -0.019620517
## [13,]  0.044621267 -0.37454675 -0.019593263
## [14,]  0.043976056 -0.37743206 -0.018045949
## [15,]  0.002608530  0.02110045 -0.405681172
## [16,]  0.002664620  0.02123110 -0.407991414
## [17,]  0.002843244  0.02118633 -0.409091995
## [18,]  0.002534198  0.02114931 -0.406372349
## [19,]  0.002533170  0.02110874 -0.408700786
## [20,]  0.002668932  0.02097038 -0.408132057</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">mod13<span class="op">$</span>priorInclusion</a></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.3999559
## [2,] 0.4432304
## [3,] 0.5825461</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">mod13<span class="op">$</span>inclusionProbabilities    </a></code></pre></div>
<pre><code>##             [,1]       [,2]      [,3]
##  [1,] 1.00000000 0.17112197 0.1337330
##  [2,] 1.00000000 0.16672704 0.1354631
##  [3,] 1.00000000 0.16733858 0.1361515
##  [4,] 1.00000000 0.17115717 0.1353939
##  [5,] 1.00000000 0.16530310 0.1350775
##  [6,] 1.00000000 0.17216159 0.1354701
##  [7,] 1.00000000 0.16869081 0.1346833
##  [8,] 0.14487471 1.00000000 0.1602905
##  [9,] 0.14315770 1.00000000 0.1606833
## [10,] 0.14049548 1.00000000 0.1577618
## [11,] 0.14275404 1.00000000 0.1600890
## [12,] 0.14545003 1.00000000 0.1600062
## [13,] 0.14661853 1.00000000 0.1608249
## [14,] 0.14156091 1.00000000 0.1533005
## [15,] 0.06453304 0.09420471 1.0000000
## [16,] 0.06480003 0.09532060 1.0000000
## [17,] 0.06458335 0.09463845 1.0000000
## [18,] 0.06482151 0.09518785 1.0000000
## [19,] 0.06436869 0.09412224 1.0000000
## [20,] 0.06505576 0.09509410 1.0000000</code></pre>
</div>
<div id="high-posterior-density-intervals" class="section level2">
<h2>High posterior density intervals</h2>
<p>It is also possible to require the computation of high probability density intervals for the elements of <span class="math inline">\(W\)</span>, which can then be plotted with the <code>plothpdi</code> function, which internally calls <code>ggplot2</code> functionalities.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="co"># Set hyperparameter values and require 50% probability density intervals </span></a>
<a class="sourceLine" id="cb69-2" data-line-number="2">ctrl10 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb69-3" data-line-number="3">                        <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb69-4" data-line-number="4">                        <span class="dt">alphatau =</span> <span class="dv">2</span>, <span class="dt">betatau =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb69-5" data-line-number="5">                        <span class="dt">hpdi =</span> <span class="ot">TRUE</span>, <span class="dt">probHPDI =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb69-6" data-line-number="6"></a>
<a class="sourceLine" id="cb69-7" data-line-number="7"><span class="co"># Estimate the model </span></a>
<a class="sourceLine" id="cb69-8" data-line-number="8">mod14 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>,</a>
<a class="sourceLine" id="cb69-9" data-line-number="9">              <span class="dt">control =</span> ctrl10, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb69-10" data-line-number="10"></a>
<a class="sourceLine" id="cb69-11" data-line-number="11"><span class="co"># Plot HPD intervals for variables 1:10 component 1 </span></a>
<a class="sourceLine" id="cb69-12" data-line-number="12"><span class="kw">plothpdi</span>(mod14, <span class="dt">d =</span> <span class="dv">1</span>, X, <span class="dt">vars =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA3lBMVEUAAAAAADoAAGYAOpAAZmYAZrYzMzM6AAA6AGY6Ojo6OpA6kNtNTU1NTW5NTY5Nbo5NbqtNjshmAABmADpmAGZmOpBmZrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq8huq+SOTU2OTW6OTY6Obk2ObquOjo6OyP+QOgCQOjqQZgCQkGaQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2///Ijk3Ijm7I5KvI///bkDrb/7bb///kq27k/8jk/+Tk///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T////tGWDVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ70lEQVR4nO2dC3ubNhSG1WXZLbRrspvbNXPWbsm2Jlub1FvTesvNcaz//4eGwDYCBEcCCYT4ztOnQT46DnqDjrA+JDMOqzXW9wn4bgBEGAARBkCEARBhAESYY0DXia1/bKxQJNw2g5l+MAARtQGIqA1ARO1xAjIIBiDCDUCEG4AI9zgBMf1gACJqA9A1Y64ALX58vzmcHRdeEKVn0ZNN2X4bbQFiiVXXbgNIMgWg5dExnz+98hKQVLQIaHF4xVdn5/GFER3zxYtXT/6JeaQlPvs1eTF+YXm0vm5E9eXP554DYkxBqCGgGE7c6n/jNscgFs8SHsu0xGdPr8SL4mjK5/s5QJ/FRr97R8Y0rRyo8ebzqfgX2/JlwmLdo+JS0sVmx2ti4oV1F3vs+xVkNQctDv+LLyI+i+JOtAWUlPjf5xtAR1EUpVji3vfTmZ+AmHRoEdDq7M3hlbgw1r0p4ZFmnvgKWp0mgF7KA9m2ZL+NXg7z82ia4Fg8P18DWpf4bJ9nOeg2GbtEZ0uzkeeA6msbARIoYkrR16+ON10sLYlR7PH5ZhRbJ57bKNqM8mMB1Nzst7GrYAAi3ABEuAGIcI8TENMPBiCiNgARtQGIqD1OQEjSAARAAIQkPRRAkH3KRSYd9if7iAkzT2UfJh32K/t4OuWaFXuUfbZXkE+yj67qU9Z97Ms+4lrydcpVKvYn+4gJ7NsnvnexHmUfoW34Kj2zXMHeMG8k+/h8BTH9YCNAxrLPRnkeC6DmZr+NANRRkqbcAES4AYhwAxDhHicgph8MQERtACJqAxBRe5yAkKQBCIAAaFvcTlcFl6TrZZ95JOyYAiTN6AUHSDKVLsb5eupsLIAMZR/OsxnXakCy7DJ0QIayT2zpQUH2aaK5eGAOZB/pAvKtizkaxQxX+2QZaCyATFf7zKbbw7rz6GGYd3UfZCT7JDlLB5DzNpaLTD/YCJCZ7COloLEAam722whAANQjIFdJGoAAqFQEIMI9TkBMPxiAiNoARNQGIKL2OAEhSQPQmAAFNB9UMGK1z+pU5ynXgFSNOlMBil+D7FMj++S2Wqo8jxHLPovDv9IulpN99JbauBZ+Gry9fdknQXjoZxdzlKQNV/vo7aMYEiAz2Wf5i+Zqn4CGeTPZZ6bVxTpoY6tgI0CGss/REFY9U7WNADU3+20EIAACIH8B2UjSl4xNLnc+AlAFoIudDweTh5NdAFIDuj+YxP/4zSfvAGiMgJh+cAUgfim62P3Bnh0+AQLiN+IzpC0+IQKya/bbCEAeJ+n7g+3EXqBJ2saNol2rOY9sb5rgABGyj1juQ+7+Ik0oDgxQMopNdFlVyD5bqzyPfgAx/eAqQJci++TvgwxlH/k58kpAsuozKEDiNlpcRnKSNt3k7Wi9nq6B7KNxzbay9rKPCpCp7PP8PLuKKv9Qg+1iN2kXyyUh09U+PMtDlecxyCRddR9k/t0+NKCwhnkj2Uf8v/rTz03eXAEyk33m/m7yZgHQ3echf9Rg+sEVgB5O9h5OJoUkDUCZCTQXe/zG1qy9/TZ6AOhyF1Ou1TnoIqFjTfex38a+k3SchPgFe/TaDp8AAVm2XtvYKhiACLcKUCKKBT3lyvSDVYAcmP029n6jaOsWMVBA9u6hAwXE7T354iOg9qNYl0k6oMeAC0bIPmK9z0bYqD6PkB4krzE1oHkULiDFfJDxJm9xHRKQrPsMKUmr5oNMN3lbnb09bSj7+L/aRzkfZLjJ23zqbQ5i+sE1gErzQcarfQIGpJwPMpN90q1KpxSgoQ7zyvkgs9U+esN8B21sFVwFSGlmsk+4gO6/16FlZL22sVWwEtCBtY8YngJi+sEqQOlHMasf5+23se9RTCxmsfaUdJCAksso1NU+TD+4BhAvPkAVDiA7w3zAV5ANQEHnoNaAQh/F2t8HWdOc/QTE9IOVgL6zOmEfHiAHZr+NAARAw03SHQMa5oSZjhG62G2ks/vLUGUfQ1MASqbTNl9iU30eAQEy//KjjFjleQxVF1OZ+ZcfpUdNdDH6bFpZe11MaaZffrR4NrKdOM2XQ/m6Cx7TDzYB5GY5VEjDvPFyKK1tAp23sVWwESAsh3JmvbaxVfA4ATH9YAAiagMQURuAiNrjBIQkDUAABEBI0gAEQADkBaCA5oMKRsg+6/l8AlBAqkadKQAl8/nP/ZxydQPIUPa53efaW3R1Lfu4AdRA9kmmXHOyj57wQ59MO/NE9uGr0/VaFt+6GNMPNgFkKvssjzZ8RgLIUPYRvZAG1Mswz65r3Y1HMSPZR+bj242iq2HeSPZJF9RpCIfO29gq2AhQc+u1ja2CAYhwjxMQ0w8GIKI2ABG1AYioPU5ASNIABEAAhCQNQAA0DkCMWQdEbn+XlJdH0WafHN8ASUVpRlNZuxEgyZSAbsUsrNgbR2O1j4U2tgq2Ach0mc/s8RtRfvk+A+e0jW2CZdlJWVsHkLnek8w3Hl4pZZ9+TW+xkYJGbRcz1ntEBZ+XIjDp0EYOMl7mk7uCRgDIeJnPwvMcxHIFC8O86fZ3oixkVV9HMaYfrAfIdPu7Ad0HUW49QK2t1za2CgYgwg1AhHucgJh+MAARtQGIqA1ARO1xAkKSBiAAAiAkaQCyA6iPL8Nm17VuW4D01J96QPKEXnCAJKtWf7wE5CZJN1N/6gHlVJehA2qm/hRln4aqS+/mZLWPtznI0X1QI/XHS0BMP9gEUCP1hwAU1jDfRP0hATVso5eAGqk/YwLU3Oy30cckDUAAVC4CEOEeJyCmHwxARG0AImoDEFG7I0BKIx7trHd3HQxAhBuACDcAEW4fJ/G8MgAiDIAIAyDCugUkP0KdfaW4wi1/w1TZK29EqHzvopKZ+eRaWqGdAsotJZuX2pi5F/I3TJW8uY0IVe99W6Cb+XJnoBPaLSB5GcfixasioNwqj/JVsPXmNiJUBMvKZcGX/xUaod0CkhYCrc7elrpYbp1Q6Q+d92ZHKneBQebLv4lGaLeApKVk82k5B8krzaRvmFJ4pY0Ile7iwwJbX66WTmh3gGZRtJ/7S+YB5d3C5HYUvdJGhMrgoV5BWWdPd4KbVrkTK2QZyZvbaE8VvGiag3ofxaQnHMpdLHOrekLmVfHJv3ehlZkvV0sntJf7oPQcKu+D1rpkMQdl3txGhMr3Vt8HrfXNqvsgdSjupAkDIMIAiDAAIgyACAMgwgCIMAAiDIAIAyDCBgno4WSP8xs24fxi1/XvGiQgfrnzkV98uReTmrj+VcMEdPfFu4ff/tj5GP90/auGCSi+cu6++vDtO3ElObZhAopzz83uw8kPIhc5toECutn5fcIvP/3mtfPfNFBA9wePXsfjmPseNlRA/CJmc3/gvocNFlBnBkCEARBhAEQYABEGQIQBEGEARBgAEQZAhP0PChhKkUEIzOAAAAAASUVORK5CYII=" alt="High posterior density intervals." />
<p class="caption">High posterior density intervals.</p>
</div>
</div>
<div id="retrieve-principal-components" class="section level2">
<h2>Retrieve Principal Components</h2>
<p>To obtain the component scores, simpy call:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="co"># Example with model mod1 </span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2">PCs &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>mod1<span class="op">$</span>muW</a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="kw">head</span>(PCs, <span class="dv">15</span>)</a></code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]   -59.19132  -78.592706  31.3401006
##  [2,]    28.97173 -118.789001 -29.0200757
##  [3,]   -11.00518   14.227039  -4.8429359
##  [4,]    92.16140  -33.606390 -28.1184464
##  [5,]   -41.61482 -212.440556  13.4800625
##  [6,]   113.51610  -20.107248   5.6778539
##  [7,]    98.45308  -73.892682  17.2711799
##  [8,]    42.05467 -142.922656 -68.0937444
##  [9,]   -57.38540  -66.586046  17.5396890
## [10,]    42.94090   51.286634  -0.2553017
## [11,]    36.39523  -11.871548  13.9383073
## [12,]   109.60474   -6.656482  25.3900540
## [13,]  -196.01791  110.020823  -9.5996904
## [14,]  -267.42318   71.336728  14.1676674
## [15,]    38.49334   22.034659 -32.6994037</code></pre>
<div id="references" class="section level3">
<h3>References</h3>
<ol style="list-style-type: decimal">
<li>C. M. Bishop. ‘Variational PCA’. In Proc. Ninth Int. Conf. on Artificial Neural Networks. ICANN, 1999.</li>
<li>E. I. George, R. E. McCulloch (1993). ‘Variable Selection via Gibbs Sampling’. Journal of the American Statistical Association (88), 881-889.</li>
</ol>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
