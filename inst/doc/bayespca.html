<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Davide Vidotto d.vidotto@uvt.nl" />

<meta name="date" content="2019-06-05" />

<title>bayespca Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">bayespca Package</h1>
<h4 class="author"><em>Davide Vidotto <a href="mailto:d.vidotto@uvt.nl">d.vidotto@uvt.nl</a></em></h4>
<h4 class="date"><em>2019-06-05</em></h4>



<div id="bayespca-a-package-for-variational-bayes-pca" class="section level1">
<h1>bayespca: A package for Variational Bayes PCA</h1>
<div id="theoretical-background" class="section level2">
<h2>Theoretical background</h2>
<p>Principal Components Analysis (PCA) allows performing dimensionality reduction via matrix factorization. While there are several ways to express a PCA model, in what follows will we consider the formulation <span class="math display">\[ X = X W P^T + E, \]</span> where X is a <span class="math inline">\(I \times J\)</span> data matrix (<span class="math inline">\(I\)</span> is the number of units; <span class="math inline">\(J\)</span> the number of continuous variables); <span class="math inline">\(W\)</span> is a <span class="math inline">\(J \times D\)</span> weight matrix (<span class="math inline">\(D \leq J\)</span> is the rank of the reduced matrix); <span class="math inline">\(P\)</span> is the orthogonal loading matrix, such that <span class="math inline">\(P^T P = I_{D \times D}\)</span>; and <span class="math inline">\(E\)</span> is an <span class="math inline">\(I \times J\)</span> error matrix. The <span class="math inline">\(D\)</span> principal components can be retrieved with <span class="math inline">\(Z = X W\)</span>. In this context, the focus of the inference is typically on <span class="math inline">\(W\)</span>. In particular, when <span class="math inline">\(J\)</span> is large and the main inferential goal is components’ interpretation, it is important for the analyst to obtain simple and interpretable components.</p>
<p>The <code>bayespca</code> package allows performing the following operations:</p>
<ol style="list-style-type: decimal">
<li>estimation of the PCA model, with a Variational Bayes algorithm;<br />
</li>
<li>regularization of the elements of <span class="math inline">\(W\)</span> by means of its prior variances;</li>
<li>variable selection, via a Stochastic Search Variable Selection method (a form of “spike-and-slab” prior).</li>
</ol>
<p>The Variational Bayes algorithm sees the columns of <span class="math inline">\(W\)</span> as latent variables, and <span class="math inline">\(P\)</span> as a fixed parameter. Furthermore, the residuals <span class="math inline">\(E\)</span> are assumed to be distributed according to a Normal distribution with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>. The following prior is assumed for the <span class="math inline">\(d\)</span>-th column of <span class="math inline">\(W\)</span>:</p>
<p><span class="math display">\[ w_d \sim MVN(0, T_d)  \]</span></p>
<p>where <span class="math inline">\(MVN()\)</span> denotes the density of the Multivariate Normal Matrix, and T_d denotes the prior (diagonal) covariance matrix of the <span class="math inline">\(d\)</span>-th component. The <span class="math inline">\(j\)</span>-th element of the diagonal of <span class="math inline">\(T_d\)</span> will be denoted <span class="math inline">\(\tau_{dj}\)</span>.<br />
where <span class="math inline">\(MVN()\)</span> denotes the density of the Multivariate Normal Matrix, and T_d denotes the prior (diagonal) covariance matrix of the <span class="math inline">\(d\)</span>-th component. The <span class="math inline">\(j\)</span>-th element of the diagonal of <span class="math inline">\(T_d\)</span> will be denoted <span class="math inline">\(\tau_j\)</span>.</p>
</div>
<div id="the-bayespca-package" class="section level2">
<h2>The <code>bayespca</code> package</h2>
<p>Variational Bayes PCA is implemented through the <code>vbpca</code> function, which takes the following arguments as inputs:</p>
<ul>
<li><code>X</code> the input matrix;</li>
<li><code>D</code> the number of components to be estimated;</li>
<li><code>maxIter</code> the maximum number of iterations for the Variational Bayes algorithm;</li>
<li><code>tolerance</code> convergence criterion of the algorithm (relative difference between ELBO values);</li>
<li><code>verbose</code> logical parameter which prints estimation information on screen when <code>TRUE</code>;</li>
<li><code>tau</code> value of the prior variances; starting value when <code>updatetau=TRUE</code> or <code>priorvar!='fixed'</code></li>
<li><code>updatetau</code> logical parameter denoting whether the prior variances should be updated when <code>priorvar='fixed'</code>;</li>
<li><code>priorvar</code> character argument denoting whether the prior variances should be <code>'fixed'</code>, or random with <code>'jeffrey'</code> or <code>'invgamma'</code> priors;<br />
</li>
<li><code>SVS</code> logical argument which activates Stochastic Variable Selection when set to <code>TRUE</code>;</li>
<li><code>priorInclusion</code> prior inclusion probabilities for the elements of <span class="math inline">\(W\)</span> in the model;</li>
<li><code>global.var</code> logical parameter which activates component-specific prior variances when set to <code>TRUE</code>;</li>
<li><code>control</code> other control parameters, such as Inverse Gamma hyperparameters (see <code>?vbpca_control</code> for more information).</li>
</ul>
<p><code>vbpca</code> returns a vbpca object, which is a list containing various aspect of the model results. See <code>?vbpca</code> for further information. Internally, <code>vbpca</code> calls a C++ function (written with Rcpp) to estimate the model.</p>
<p>In what follows, the various estimation modalities allowed by <code>vbpca</code> will be introduced. For presentation purposes, a synthetic data matrix with <span class="math inline">\(I = 100\)</span> rows and <span class="math inline">\(J = 20\)</span> columns genereted from three components will be used:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">141</span>)
I &lt;-<span class="st"> </span><span class="dv">100</span>
J &lt;-<span class="st"> </span><span class="dv">20</span> 
V1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">50</span>)
V2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">30</span>)
V3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">10</span>)
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(V1, <span class="dv">7</span>), <span class="kw">rep</span>(V2, <span class="dv">7</span>), <span class="kw">rep</span>(V3, <span class="dv">6</span>)), I, J)
X &lt;-<span class="st"> </span>X <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(I <span class="op">*</span><span class="st"> </span>J, <span class="dv">0</span>, <span class="dv">1</span>), I, J)</code></pre></div>
<p>I will now proceed with the estimation of the PCA model.</p>
</div>
<div id="levels-of-regularization-on-the-w-matrix" class="section level2">
<h2>Levels of regularization on the W matrix</h2>
<div id="fixed-tau" class="section level3">
<h3>Fixed <code>tau</code></h3>
<p>With fixed tau, it is possible to specify the model as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install and load package </span>
<span class="co"># devtools::install_github(&quot;davidevdt/bayespca&quot;)</span>
<span class="kw">library</span>(bayespca)


<span class="co"># De-activate data center and scaling;</span>
ctrl &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>, 
                      <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>)


<span class="co"># Estimate vbpca with fixed prior variances (equal to 1) </span>
<span class="co"># for the elements of W </span>
mod1 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>, 
              <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test the class of mod1: </span>
<span class="kw">is.vbpca</span>(mod1)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The estimate posterior means of the <span class="math inline">\(W\)</span> matrix can be viewed with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1<span class="op">$</span>muW </code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376589697 -0.04416511  0.0003399127
##  [2,] -0.373939776 -0.04582346 -0.0111489577
##  [3,] -0.375148656 -0.04305857 -0.0078831833
##  [4,] -0.374770076 -0.04473100 -0.0031124936
##  [5,] -0.376808025 -0.04285791 -0.0100250666
##  [6,] -0.375114064 -0.04446329 -0.0015012122
##  [7,] -0.375069345 -0.04364081 -0.0007181137
##  [8,]  0.043916073 -0.37610684 -0.0194987814
##  [9,]  0.044338996 -0.37382689 -0.0224165501
## [10,]  0.043216238 -0.37319455 -0.0161965551
## [11,]  0.043432789 -0.37311089 -0.0246530479
## [12,]  0.045420158 -0.37574266 -0.0200072027
## [13,]  0.045158091 -0.37616395 -0.0206149535
## [14,]  0.044605650 -0.37571347 -0.0144837510
## [15,]  0.002905219  0.02229238 -0.4057459196
## [16,]  0.003409761  0.02199152 -0.4068881251
## [17,]  0.003232844  0.02063894 -0.4106993259
## [18,]  0.002919709  0.02319335 -0.4056784549
## [19,]  0.002019259  0.02192116 -0.4088023613
## [20,]  0.001874207  0.02043128 -0.4078307380</code></pre>
<p>and the <span class="math inline">\(P\)</span> matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1<span class="op">$</span>P </code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376589904 -0.04416517  0.0003399179
##  [2,] -0.373939981 -0.04582353 -0.0111491289
##  [3,] -0.375148862 -0.04305863 -0.0078833043
##  [4,] -0.374770282 -0.04473106 -0.0031125414
##  [5,] -0.376808232 -0.04285797 -0.0100252205
##  [6,] -0.375114270 -0.04446335 -0.0015012352
##  [7,] -0.375069551 -0.04364087 -0.0007181247
##  [8,]  0.043916097 -0.37610735 -0.0194990808
##  [9,]  0.044339020 -0.37382740 -0.0224168943
## [10,]  0.043216262 -0.37319506 -0.0161968038
## [11,]  0.043432813 -0.37311139 -0.0246534264
## [12,]  0.045420183 -0.37574317 -0.0200075099
## [13,]  0.045158115 -0.37616446 -0.0206152700
## [14,]  0.044605675 -0.37571398 -0.0144839734
## [15,]  0.002905220  0.02229241 -0.4057521497
## [16,]  0.003409762  0.02199155 -0.4068943728
## [17,]  0.003232846  0.02063897 -0.4107056321
## [18,]  0.002919710  0.02319338 -0.4056846840
## [19,]  0.002019260  0.02192119 -0.4088086384
## [20,]  0.001874208  0.02043131 -0.4078370001</code></pre>
<p>Among other things, the function returns also the model evidence lower bound (ELBO) and the estimation time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1<span class="op">$</span>elbo </code></pre></div>
<pre><code>## [1] -2834.329</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1<span class="op">$</span>time </code></pre></div>
<pre><code>##    user  system elapsed 
##    0.01    0.01    0.03</code></pre>
</div>
<div id="fixed-updatable-tau" class="section level3">
<h3>Fixed, updatable <code>tau</code></h3>
<p>The prior variances <span class="math inline">\(\tau_{dj}\)</span> can also be updated via Type-II Maximum Likelihood (empirical Bayes updates):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod2 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>,
              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod2<span class="op">$</span>muW</code></pre></div>
<pre><code>##         Component 1  Component 2  Component 3
##  [1,] -3.770417e-01 -0.051573499 -0.001788633
##  [2,] -3.747997e-01 -0.025120541 -0.002279085
##  [3,] -3.749896e-01 -0.039169668 -0.002284711
##  [4,] -3.695986e-01 -0.062446420 -0.002188222
##  [5,] -3.798267e-01 -0.031100065 -0.002172447
##  [6,] -3.809607e-01 -0.058646546 -0.001863930
##  [7,] -3.707615e-01 -0.037076450 -0.001858450
##  [8,]  4.610643e-02 -0.388243166 -0.019761887
##  [9,]  4.122547e-02 -0.376699340 -0.023207406
## [10,]  2.542203e-02 -0.376987920 -0.006935656
## [11,]  5.233439e-02 -0.374340986 -0.022206305
## [12,]  4.536997e-02 -0.374395905 -0.013879307
## [13,]  6.378896e-02 -0.370090650 -0.031591876
## [14,]  3.106493e-02 -0.364598986 -0.002519184
## [15,]  5.847012e-06  0.006198051 -0.406003865
## [16,]  6.041405e-06  0.018464891 -0.407039992
## [17,]  5.235991e-06  0.009013294 -0.411151002
## [18,]  3.518425e-06  0.036121023 -0.398782724
## [19,]  6.288835e-06  0.005824170 -0.410563013
## [20,]  6.214579e-06  0.034945874 -0.412808540</code></pre>
<p>The matrix of the inverse prior variances can be called with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod2<span class="op">$</span>invTau</code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] 6.723601e+00  184.301092 31906.370412
##  [2,] 6.797876e+00  437.595910 25321.510608
##  [3,] 6.720477e+00  245.899700 25234.633839
##  [4,] 6.909797e+00  136.385519 26302.854255
##  [5,] 6.614756e+00  336.071864 26671.584545
##  [6,] 6.538464e+00  150.961175 30414.866200
##  [7,] 6.920149e+00  278.098092 30606.846242
##  [8,] 1.973803e+02    6.278101   670.761526
##  [9,] 2.288287e+02    6.657350   569.759379
## [10,] 4.149292e+02    6.642324  1989.950540
## [11,] 1.699204e+02    6.739745   597.851184
## [12,] 2.026152e+02    6.706750   970.392618
## [13,] 1.292935e+02    6.822902   390.944658
## [14,] 3.536290e+02    7.210202  5658.371090
## [15,] 3.158381e+05 2396.464628     5.835080
## [16,] 3.162767e+05  757.091274     5.769939
## [17,] 3.264009e+05 1565.810035     5.674352
## [18,] 3.196566e+05  348.615143     5.995065
## [19,] 3.198439e+05 2526.927987     5.707424
## [20,] 3.182544e+05  363.292432     5.588104</code></pre>
</div>
<div id="random-tau-jeffreys-prior" class="section level3">
<h3>Random <code>tau</code>: Jeffrey’s prior</h3>
<p>By assuming Jeffrey’s hyperpriors on <span class="math inline">\(\tau_{d,j}\)</span> we set:</p>
<p><span class="math display">\[ p(\tau_{d,j}) \propto \frac{1}{\tau_{d,j}}.  \]</span></p>
<p>The following code runs the algorithm with Jeffrey’s priors on <code>tau</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod3 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, 
              <span class="dt">priorvar =</span> <span class="st">'jeffrey'</span>, <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod3<span class="op">$</span>muW</code></pre></div>
<pre><code>##         Component 1  Component 2  Component 3
##  [1,] -3.757646e-01 -0.051773160 -0.001684598
##  [2,] -3.756863e-01 -0.024773150 -0.002122048
##  [3,] -3.758101e-01 -0.039042545 -0.002125161
##  [4,] -3.692192e-01 -0.062594644 -0.002042117
##  [5,] -3.808786e-01 -0.030957878 -0.002028616
##  [6,] -3.802877e-01 -0.058870639 -0.001748039
##  [7,] -3.703552e-01 -0.036931472 -0.001746713
##  [8,]  4.721080e-02 -0.388387203 -0.019681028
##  [9,]  4.143813e-02 -0.376808913 -0.023157487
## [10,]  2.659771e-02 -0.377040717 -0.006727279
## [11,]  5.011560e-02 -0.374286630 -0.022163915
## [12,]  4.536128e-02 -0.374432238 -0.013520621
## [13,]  6.304093e-02 -0.370068016 -0.031431258
## [14,]  3.134111e-02 -0.364405736 -0.002414999
## [15,] -1.171811e-05  0.005936644 -0.406010842
## [16,] -1.146225e-05  0.018071121 -0.406913644
## [17,] -1.192092e-05  0.008654023 -0.411149650
## [18,] -1.359439e-05  0.036363148 -0.398751160
## [19,] -1.127322e-05  0.005569321 -0.410649936
## [20,] -1.140226e-05  0.034939861 -0.412915798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod3<span class="op">$</span>invTau </code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] 6.767590e+00  183.413237 35792.389870
##  [2,] 6.767276e+00  444.807011 28717.737815
##  [3,] 6.692741e+00  246.914788 28653.864298
##  [4,] 6.923187e+00  135.973349 29770.336740
##  [5,] 6.579887e+00  337.917431 30166.978285
##  [6,] 6.560514e+00  150.229799 34271.225139
##  [7,] 6.934665e+00  279.497089 34407.243746
##  [8,] 1.915903e+02    6.273751   676.164204
##  [9,] 2.275212e+02    6.653730   573.008331
## [10,] 3.946490e+02    6.640583  2059.789146
## [11,] 1.794492e+02    6.741653   601.092050
## [12,] 2.026344e+02    6.705600  1000.451289
## [13,] 1.312116e+02    6.823768   394.628449
## [14,] 3.499053e+02    7.217607  5917.649067
## [15,] 3.510386e+05 2512.207931     5.834906
## [16,] 3.515804e+05  778.039953     5.773433
## [17,] 3.627243e+05 1637.770072     5.674439
## [18,] 3.549667e+05  347.219129     5.996028
## [19,] 3.555498e+05 2652.878683     5.705122
## [20,] 3.539059e+05  364.874639     5.585392</code></pre>
</div>
<div id="random-tau-inverse-gamma-prior" class="section level3">
<h3>Random <code>tau</code>: Inverse Gamma prior</h3>
<p>It is possible to specify an inverse gamma prior on <span class="math inline">\(\tau_{d,j}\)</span>:</p>
<p><span class="math display">\[ \tau_{d,j} \sim IG(\alpha, \beta) \]</span></p>
<p>with <span class="math inline">\(\alpha\)</span> shape parameter and <span class="math inline">\(\beta\)</span> scale parameter. The following code implements an IG(2, .5) prior on the variances:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set hyperparameter values </span>
ctrl2 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>,
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                       <span class="dt">alphatau =</span> <span class="dv">2</span>, <span class="dt">betatau =</span> .<span class="dv">5</span>)
                       
                       
                       
<span class="co"># Estimate the model </span>
mod4 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, 
              <span class="dt">control =</span> ctrl2, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod4<span class="op">$</span>muW </code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376590647 -0.04416831  0.0002942783
##  [2,] -0.373916145 -0.04580796 -0.0111136115
##  [3,] -0.375152371 -0.04306335 -0.0078482119
##  [4,] -0.374771589 -0.04473679 -0.0031289018
##  [5,] -0.376819230 -0.04285286 -0.0099901143
##  [6,] -0.375128398 -0.04445794 -0.0015202569
##  [7,] -0.375056419 -0.04365149 -0.0007404096
##  [8,]  0.043918311 -0.37612413 -0.0195192789
##  [9,]  0.044336971 -0.37380675 -0.0224249935
## [10,]  0.043215376 -0.37316095 -0.0162247651
## [11,]  0.043435543 -0.37309948 -0.0245954650
## [12,]  0.045416531 -0.37575287 -0.0200104086
## [13,]  0.045161134 -0.37621159 -0.0206043931
## [14,]  0.044602975 -0.37569136 -0.0144839228
## [15,]  0.002901088  0.02228831 -0.4056882953
## [16,]  0.003405222  0.02198276 -0.4068836318
## [17,]  0.003228802  0.02064986 -0.4107113728
## [18,]  0.002920826  0.02319232 -0.4056318015
## [19,]  0.002018519  0.02191736 -0.4087805942
## [20,]  0.001885975  0.02043594 -0.4078297610</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod4<span class="op">$</span>invTau</code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]    4.349513    4.952224    4.961845
##  [2,]    4.357094    4.951479    4.961185
##  [3,]    4.348866    4.946652    4.955442
##  [4,]    4.346970    4.942133    4.951918
##  [5,]    4.346201    4.949399    4.957941
##  [6,]    4.348419    4.945415    4.955085
##  [7,]    4.353566    4.952076    4.961437
##  [8,]    4.940075    4.341259    4.947637
##  [9,]    4.943619    4.350731    4.950784
## [10,]    4.946272    4.354243    4.954138
## [11,]    4.941374    4.350682    4.947635
## [12,]    4.939956    4.342697    4.948068
## [13,]    4.934268    4.336865    4.942105
## [14,]    4.953804    4.353473    4.962576
## [15,]    4.963713    4.961313    4.266473
## [16,]    4.954953    4.952599    4.256391
## [17,]    4.956272    4.954215    4.246050
## [18,]    4.953989    4.951371    4.259347
## [19,]    4.962076    4.959717    4.256072
## [20,]    4.950147    4.948089    4.249971</code></pre>
<p><code>alphatau</code> and <code>betatau</code> can also be specified as <span class="math inline">\(D\)</span>-dimensional array, in which case the Inverse Gamma will have component-specific hyperparameters: <span class="math display">\[ \tau_{d,j} \sim IG(\alpha_d, \beta_d) \]</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set hyperparameter values </span>
ctrl3 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>,
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                       <span class="dt">alphatau =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">50</span>, <span class="dv">3</span>), <span class="dt">betatau =</span> <span class="kw">c</span>(.<span class="dv">5</span>, .<span class="dv">01</span>, <span class="dv">10</span>), 
                       <span class="dt">hypertype =</span> <span class="st">'component'</span>)
                       
                       
<span class="co"># Estimate the model </span>
mod5 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, 
              <span class="dt">control =</span> ctrl3, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod5<span class="op">$</span>muW </code></pre></div>
<pre><code>##        Component 1  Component 2   Component 3
##  [1,] -0.378543478 -0.022403852  0.0025386295
##  [2,] -0.376019722 -0.021196983 -0.0088612115
##  [3,] -0.377066494 -0.022557126 -0.0057270031
##  [4,] -0.376774699 -0.022650241 -0.0008814042
##  [5,] -0.378720012 -0.022357681 -0.0078768015
##  [6,] -0.377102619 -0.019528818  0.0007032582
##  [7,] -0.376989874 -0.026248142  0.0014710887
##  [8,]  0.021470521 -0.045359009 -0.0012343390
##  [9,]  0.022018693 -0.049787441 -0.0042453561
## [10,]  0.020952041 -0.037610876  0.0018996414
## [11,]  0.021150966 -0.048838642 -0.0065159768
## [12,]  0.022990213 -0.048959831 -0.0017490218
## [13,]  0.022694280 -2.350959262 -0.0024775177
## [14,]  0.022197501 -0.048663411  0.0037657268
## [15,]  0.002988814  0.002048412 -0.4063509956
## [16,]  0.003472519 -0.001954198 -0.4074615231
## [17,]  0.003201167  0.008962963 -0.4112475488
## [18,]  0.003059452  0.006509927 -0.4063451138
## [19,]  0.002074293  0.003760222 -0.4093932228
## [20,]  0.001853458 -0.003935007 -0.4083201342</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod5<span class="op">$</span>invTau </code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]    1.734909  4885.51101   0.3498302
##  [2,]    1.737796  4897.91867   0.3498294
##  [3,]    1.734283  4883.57903   0.3498025
##  [4,]    1.733024  4882.65984   0.3497829
##  [5,]    1.733356  4885.97064   0.3498127
##  [6,]    1.733921  4914.16337   0.3497986
##  [7,]    1.736550  4841.25146   0.3498290
##  [8,]    1.974069  4535.17321   0.3497716
##  [9,]    1.975981  4450.34973   0.3497902
## [10,]    1.977182  4671.07826   0.3498009
## [11,]    1.974679  4468.90214   0.3497765
## [12,]    1.974249  4466.51594   0.3497748
## [13,]    1.971273    18.20417   0.3497460
## [14,]    1.981100  4472.66011   0.3498376
## [15,]    1.982219  5007.34354   0.3469767
## [16,]    1.977733  5007.36672   0.3469196
## [17,]    1.978365  4988.53185   0.3468718
## [18,]    1.977266  4997.70264   0.3469310
## [19,]    1.981324  5004.97797   0.3469253
## [20,]    1.975283  5004.39805   0.3468847</code></pre>
<p>Notice the different level of regularization obtained across the different components. In order to activate these ‘component-specific’ hyperpriors, <code>hypertype = 'component'</code> was specified.</p>
</div>
<div id="random-tau-random-betatau" class="section level3">
<h3>Random <code>tau</code>, random <code>betatau</code></h3>
<p>It is also possible to specify a Gamma hyperprior on <span class="math inline">\(\beta\)</span> (while <span class="math inline">\(\alpha\)</span> remains fixed): <span class="math display">\[ \beta \sim Ga(\gamma, \delta). \]</span> This is achievable by setting <code>gammatau</code> (and <code>deltatau</code>) larger than 0 in the control parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Specify component-specific Gamma(.01, 10) hyperpriors on betatau </span>
ctrl4 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>, 
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                       <span class="dt">alphatau =</span> <span class="dv">1</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,
                       <span class="dt">gammatau =</span> .<span class="dv">01</span>, <span class="dt">deltatau =</span> <span class="dv">10</span>, 
                       <span class="dt">hypertype =</span> <span class="st">'component'</span>)

                       
<span class="co"># Estimate the model </span>
mod6 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, 
              <span class="dt">control =</span> ctrl4, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod6<span class="op">$</span>muW </code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376611437 -0.04414830 -0.001252671
##  [2,] -0.373522305 -0.04527018 -0.009487805
##  [3,] -0.375303126 -0.04330237 -0.006687095
##  [4,] -0.374545174 -0.04476030 -0.003779739
##  [5,] -0.377135323 -0.04290004 -0.008530456
##  [6,] -0.375471472 -0.04449079 -0.002519439
##  [7,] -0.374841518 -0.04378470 -0.001756540
##  [8,]  0.044091734 -0.37646021 -0.020075478
##  [9,]  0.044279171 -0.37340282 -0.022181983
## [10,]  0.043230863 -0.37275698 -0.017353060
## [11,]  0.043633682 -0.37285414 -0.022657108
## [12,]  0.045225592 -0.37597481 -0.020153766
## [13,]  0.045217385 -0.37690958 -0.020321214
## [14,]  0.044311525 -0.37546975 -0.014960798
## [15,]  0.002829728  0.02204140 -0.405116611
## [16,]  0.003208895  0.02187057 -0.407344521
## [17,]  0.003155312  0.02095411 -0.410909109
## [18,]  0.002824576  0.02288662 -0.405229626
## [19,]  0.002136107  0.02174443 -0.408747297
## [20,]  0.002177548  0.02077097 -0.407952211</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod6<span class="op">$</span>invTau </code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]    14.89847    49.95597    64.79114
##  [2,]    15.06380    49.85157    64.48104
##  [3,]    14.87935    49.45351    63.73992
##  [4,]    14.89953    49.19672    63.74737
##  [5,]    14.83146    49.84022    64.32954
##  [6,]    14.87624    49.45017    63.91513
##  [7,]    14.97986    49.94842    64.56200
##  [8,]    48.95314    14.77489    62.76748
##  [9,]    49.16960    14.97374    62.96668
## [10,]    49.41724    15.02556    63.45826
## [11,]    49.04970    14.98706    62.69018
## [12,]    48.92027    14.79264    62.77075
## [13,]    48.53974    14.68576    62.16584
## [14,]    50.07132    15.00763    64.71429
## [15,]    51.73889    51.41043    14.14011
## [16,]    51.12230    50.69433    13.94199
## [17,]    51.27494    50.94174    13.77126
## [18,]    51.01890    50.58728    14.03940
## [19,]    51.71281    51.34808    13.93690
## [20,]    50.73849    50.38297    13.85877</code></pre>
<p>The posterior means of <span class="math inline">\(\beta\)</span> can be accessed via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod6<span class="op">$</span>priorBeta </code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]
## [1,] 0.02643281 0.02638618 0.02076472
## attr(,&quot;names&quot;)
## [1] &quot;beta 1&quot; &quot;beta 2&quot; &quot;beta 3&quot;</code></pre>
<p><code>hypertype</code> specify the type of hyperprior for <code>beta</code>:</p>
<ul>
<li><code>'common'</code> implies <span class="math inline">\(\beta \sim Ga(\alpha, \beta)\)</span>;</li>
<li><code>'component'</code> implies <span class="math inline">\(\beta_d \sim Ga(\alpha_d, \beta_d)\)</span>;</li>
<li><code>'local'</code> implies <span class="math inline">\(\beta_{dj} \sim Ga(\alpha_{dj}, \beta_{dj})\)</span>.</li>
</ul>
<p>Similar to <code>alphatau</code> and <code>betatau</code>, <code>gammatau</code> and <code>deltatau</code> can also be <span class="math inline">\(D\)</span>-dimensional arrays for component-specific hyperpriors on <span class="math inline">\(\beta\)</span>.</p>
</div>
<div id="global-prior-variances" class="section level3">
<h3>Global prior variances</h3>
<p>So far, the parameter <code>global.var</code> has always ben set to <code>FALSE</code>, implying <span class="math display">\[ w_{j,d} \sim N(0, \tau_{j,d}). \]</span> Setting <code>global.var = TRUE</code> will modify this formulation, which will switch to <span class="math display">\[ w_{j,d} \sim N(0, \tau_{d}) \]</span> that is, component-specific variances (called ‘global variances’ in <code>vbpca</code>) will be estimated instead:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fixed prior global variances, updated via Type-II maximum likelihood: </span>
mod7 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>,
              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, 
              <span class="dt">global.var =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt="Prior variances for the first 3 components." />
<p class="caption">Prior variances for the first 3 components.</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod7<span class="op">$</span>muW </code></pre></div>
<pre><code>##        Component 1 Component 2   Component 3
##  [1,] -0.376586343 -0.04416414  0.0003398280
##  [2,] -0.373936445 -0.04582246 -0.0111461792
##  [3,] -0.375145315 -0.04305763 -0.0078812187
##  [4,] -0.374766738 -0.04473002 -0.0031117179
##  [5,] -0.376804669 -0.04285697 -0.0100225682
##  [6,] -0.375110723 -0.04446231 -0.0015008380
##  [7,] -0.375066004 -0.04363985 -0.0007179347
##  [8,]  0.043915682 -0.37609858 -0.0194939220
##  [9,]  0.044338601 -0.37381868 -0.0224109636
## [10,]  0.043215853 -0.37318635 -0.0161925187
## [11,]  0.043432402 -0.37310269 -0.0246469040
## [12,]  0.045419753 -0.37573441 -0.0200022167
## [13,]  0.045157688 -0.37615568 -0.0206098160
## [14,]  0.044605253 -0.37570521 -0.0144801414
## [15,]  0.002905193  0.02229189 -0.4056448021
## [16,]  0.003409730  0.02199104 -0.4067867230
## [17,]  0.003232816  0.02063848 -0.4105969740
## [18,]  0.002919683  0.02319284 -0.4055773542
## [19,]  0.002019241  0.02192068 -0.4087004821
## [20,]  0.001874190  0.02043083 -0.4077291009</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod7<span class="op">$</span>invTau </code></pre></div>
<pre><code>## [1] 17.32691 17.32734 17.33475</code></pre>
<p>Notice the plot of the prior variances (inverse precisions) that appears in this case. This is useful when the number of components supported by the data is uncertain (elbow method):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod8 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">10</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'fixed'</span>,
              <span class="dt">updatetau =</span> <span class="ot">TRUE</span>, <span class="dt">global.var =</span> <span class="ot">TRUE</span>, 
              <span class="dt">control =</span> ctrl, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrY6AAA6ADo6AGY6ZmY6kNtmAABmZmZmkJBmtrZmtv+QOgCQOjqQZgCQtpCQ29uQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/trb/25D//7b//9v///9v7IboAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJAUlEQVR4nO2di3ajNhRFnUzHnjZua7fT0KGltvn/j6xePGSMDi9JIM5eazwOz7B9dSURIR9K4uQQ+xdYOxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDAq6D8oHn/0Sx7XA9f/+3bQax8+1TvbqeXmzn39kIQQdVVS9yXKPb4sN/YpCpo8FXdz2bTzAq7iHgWpK5SXLUIofzw9v10ePvLxIAoQyZIzAodZJl+I3Y5VhupBfbe1vLPrA7RQn4YF3OggzqE+Zgmx10IQeoqTDh9/UdfYt5EVt6OsUJbK9R1Fk0BtfbuLDeGMv3+Qwmukl/ezYNjCBRB4v9cS9BZROdgnWjy9udrypgqYWLTo4qWZiO199NyfewPI1efTO0v3n6YWCxep7QBhMtBuQ5+LcikmMxc3aXZp7m05hjH0t67s1zIOlZ5K2/2lx+QWDUrm4WrxXJdDKoYUNdpyl6rktOFq6i3VRztvbvLVZi0ajiVo/SJzbYT4yeQoEaGuUSTg7UNW5BalVXlSazX2z7pfVpeCTqagxStT8ako3aUjiFIkjY/DIogWVD+1iVEZ5muoO7yFxHU9jGnHosj6CkHWYLExf2q1xZVfvmw9+4u17L0QQsdNVUwlY8/PssZ7apIguxazBKkCpC6PLWR/LEbQU/L66pKxZHQl8kXVSPqM01vgUcSVKWnY9kRpFapAlLl4pc5qJuk63bQsW4HtVpK9jmGE0uQrmgurRU1TcUsTbx95q1y2NRi1vJW0jcVlpKog0adaXJVz9sdAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBFhZ02AyxBIl/XyTW0u6S6EQU9OXLs4+eJcueeSRRBZXmpaKzpGssOPEE6eu2dbxcsldBAyKoayw8685B+46gAbXYrnPQIKL7Wbug+FAQgIIAFASgIMAGBO2qmh9/F6GMbGgDEURBkJiGKAhAQYBNCIppiIIAFATYhqCIhigIQEGAjQiKZ4iCABQE8CKomstJ0jNZyGjfsQz5iaDHFU2isnNBwtDx5fJJ94MUiQkqCzBX2viUFsnQVpI0BUEoCBHHkKdq3sxD2z8jGAWVuZw57X7uydUUZNTkPbMSTimxUQx5E3Q7KUHFUi3pMjVBjCAHui92LKt0PfNwNTEM+arm9fT0Re/0zLsX5OVwFISIYMhbb955N2j3gvIq9zwnoem3OxSpCHpcay1LVvNlDEOeqvm6g7FkQ7FMRhAjCJFX9xN7G0J7H8RZ/V2jdwL9lAXpDFNMnRx/5HljM1mQ+mqcAOeNjW9BfVulLUjnl4nfgTPyvLGZHkGBzvtM6CfIJghqtXICnPeJ4M8gTqnmH1cYQp46qxGeYg3cWZ12uIbwz0FvrKuRSAT566xuIwdB+iNo5v2gchO12ADYWUWE6KyGCaRt3bS3oKBVsH1BnrP25gX5rvcTEFR6TUdbF+S977F1QYwgBHMQouNnWWHbF/TMwiGVoqByyaSUnKClq7XAgubf7oAwggDMQQjWYkFJW9ACkZS0oCWKWtKCloCCALsQNKde24OgWS2jfQgqp1doOxA0r3e2A0ErjKD7ufcvqlMON5f15aD7+ZcTGIW271pMPoiZH15PbzLhcMszwpg3QWpigY6jAPeDBjCmzHkUVCpHaxwnPSZr+xW0zOGWZlS9v0dB8SMo/OHGET0HhT/cSEZ89ZtXQWb+jqUO55H+mPKUg5afJtAv/VnJTwSZwa2biSBHveZtlKvsjW1GUPAIEmRvn5sSFDQHKfLDx3YE9Q+i8ViL3U4/bUfQM3VI+azmH9f+xzbXL8i87LOhCGmqNU+CvD1xGArPEeRrepxw+M1BHp84DIbXWszjE4fBiRZBm8GHoAFPHM44Dd5kkYOMDfKxfTGtH/59bMJpkhA0GQqaf5q0BI2dZWh3gsZCQfNPQ0GzN9mAINhZnXGaFATh6XHSY+GuRnos3FlND0YQIFBndbsE6qxul83c4YoFBQEoCEBBAAoCUBCAggABBKlbALhhmbkbV7fTixH+NvkBzIZ9+1l1kIrDYfjE9P4FPa7itwGPeJTyt3YKKsTa+9l5kFx9b5XD0P2sepBy2v7hU/f7F6SHW6Gb2KKN7hKku4HOg+hvEc76HZoHKPShHNvZhMpB6CPLv/7pEnT7Bj9xJEj0H9U9iGEfWE0oQZn7FxICnDmoeP/7jBIZLGL6Jo12Pfh+TSBBoPsvw94pKJelo++ruJuTgOSrrOhYHpyEwggqQI6Wt5fcgt7wxy6D9OZ8JHK1gtDtIxX1bkFKjWN47aDcstYilqNWUG6GpPRfvr4eZ6oeEBkrTdL5sO8ycUaQ+eIh11XpC3duUqyymnenhQZ3S1pmKfDNHwNz0Ooaiqb8wN8IdDUK3F/J0CYmvPJ1dTU2DgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQV5AaIbzMs1XFoCEk44kqSA+syoaPJOin9bjossQUZAaMPa4LxFCSgqoHX/9To3b02JXb6Xc5nFWOq7+Ut2/fT2ZEi1l9P8vVaoiYtUBu7+cxyIiCrEGrcvyuHEl/O6lx+e8/5CA5cdkXPbK3Wn0/y9XmnxwtVS1IMYLaM8DrwWPF26caImZeLnq8mAi0erXaR6wxX9Dw/qNZkLYgnY6Uk4v5qfpBazOrlQfxoofQtRakKKhdxLQBcZW2oG9m4Gq9uhZUjYtNWVCdpIvDpSeCbEGdCCpN7ZWqoFY138pBVhFT7SQrBz35SFqQbiiq58latZglqHo+panFtA/9bELWNuZpLoi4XQ01k4MuaHU7yBL028mMv6/bQUaQageJxkC9IEuvHYRxPpsRCAoCUBBg1YLWAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A/8kLoAfQWF2AAAAABJRU5ErkJggg==" alt="Prior variances for 10 components." />
<p class="caption">Prior variances for 10 components.</p>
</div>
</div>
</div>
<div id="stochastic-search-variable-selection" class="section level2">
<h2>Stochastic Search Variable Selection</h2>
<p>By requiring <code>SVS = TRUE</code>, the model activates stochastic-search-variable-selection, a method described by George ad McCulloch (1993) for the Gibbs Sampler. The method has been adapted in <em>bayespca</em> for the Variational Bayes algorithm. The assumed ‘spike-and-slab’ prior for the <span class="math inline">\((j,d)\)</span>-th element of <span class="math inline">\(W\)</span> becomes:</p>
<p><span class="math display">\[ w_{j,d} \sim N(0, \pi \tau + (1 - \pi) \tau v_0)  \]</span></p>
<p>where <span class="math inline">\(v_0\)</span> is a scalar which rescales the spike variance to a value close to 0. For this reason, <span class="math inline">\(v_0\)</span> should be a number included in <span class="math inline">\((0, 1)\)</span>, as close as possible to 0. <span class="math inline">\(\pi\)</span> represents the prior probability of inclusion of the <span class="math inline">\(j\)</span>-th variable in the <span class="math inline">\(d\)</span>-th component of the model. <code>vbpca</code> estimates the posterior probabilities of inclusion, conditional on <span class="math inline">\(X\)</span> and the values in <span class="math inline">\(W\)</span>.</p>
<p>While <span class="math inline">\(v_0\)</span> should be a small value close to 0, too small values of such parameter will shrink the variances <span class="math inline">\(\tau\)</span> too much, and no variable will eventually be included in the model. On the other hand, using a too large value for <span class="math inline">\(v_0\)</span> will not shrink the variances enough, and all posterior inclusion probabilities will be close to 1. <span class="math inline">\(v_0\)</span> should then be set with a grain of salt. Preliminary results from partial simulation studies have shown that values between 0.0001 and 0.005 lead to acceptable results, but adequate values of <span class="math inline">\(v_0\)</span> can be dataset-specific. Preliminary simulation studies have also shown that the method works better when Inverse Gamma priors are specified for <span class="math inline">\(\tau\)</span>, with <code>betatau</code> equal to 1 and larger values of <code>alphatau</code>. However, the technique has just been devised and further studies must be carried out to further test the functioning of Stochastic Variable Selection in this context.</p>
<p>In <code>vbpca</code>, the parameter <span class="math inline">\(v_0\)</span> is called <code>v0</code> in the control parameters of <code>vbpca_control</code>, while the prior inclusion probability is called <code>priorInclusion</code>. <code>priorInclusion</code> can be fixed, updated via Type-II maximum likelihood, or assigned to a Beta hyperprior:</p>
<ul>
<li>among the control parameters of <code>vbpca_control</code>, set <code>beta1pi</code> smaller than 0 for fixed <span class="math inline">\(\pi\)</span>;</li>
<li>set <code>beta1pi = 0</code> instead for Type-II ML updates;</li>
<li>last, set <code>beta1pi</code> larger than 0 for Beta specifications.</li>
</ul>
<p>When <code>beta1pi</code> is larger than 0, a Beta prior is assumed for <span class="math inline">\(\pi\)</span>:</p>
<p><span class="math display">\[ \pi \sim Beta(\beta_1, \beta_2).\]</span></p>
<p>In <code>vbpca</code>, <span class="math inline">\(\beta1\)</span> can be controlled with the <code>beta1pi</code> argument and <span class="math inline">\(\beta2\)</span> with the <code>beta2pi</code> argument in <code>vbpca_control</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># SVS, fixed priorInclusion and InverseGamma(5, 1) for tau, v0 = .005</span>
ctrl5 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>, 
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,
                       <span class="dt">beta1pi =</span> <span class="op">-</span><span class="dv">1</span>, <span class="dt">v0 =</span> <span class="fl">5e-03</span>)

<span class="co"># Estimate the model with priorInclusion = 0.5</span>
mod9 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>,
              <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">priorInclusion =</span> <span class="fl">0.5</span>, <span class="dt">control =</span> ctrl5,
              <span class="dt">verbose =</span> <span class="ot">FALSE</span> )                    </code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod9<span class="op">$</span>muW </code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376750692 -0.04448495 -0.004123683
##  [2,] -0.372459887 -0.04361185 -0.005752993
##  [3,] -0.375671975 -0.04356723 -0.004989270
##  [4,] -0.373836916 -0.04448097 -0.004703139
##  [5,] -0.377543656 -0.04319604 -0.005454948
##  [6,] -0.375846023 -0.04472475 -0.004528453
##  [7,] -0.375420482 -0.04399690 -0.004254785
##  [8,]  0.044408056 -0.37704714 -0.019871878
##  [9,]  0.043996739 -0.37297274 -0.020136604
## [10,]  0.043266209 -0.37568704 -0.019144528
## [11,]  0.043855992 -0.37127741 -0.019779142
## [12,]  0.044744851 -0.37518584 -0.019753061
## [13,]  0.045169754 -0.37455442 -0.019722877
## [14,]  0.043743494 -0.37734332 -0.018263649
## [15,]  0.002622365  0.02125415 -0.405655204
## [16,]  0.002687542  0.02139614 -0.407985339
## [17,]  0.002847711  0.02135195 -0.409082736
## [18,]  0.002536920  0.02132424 -0.406350545
## [19,]  0.002543555  0.02126640 -0.408688107
## [20,]  0.002678762  0.02114151 -0.408155324</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># SVS, priorInclusion update via Type-II ML and InverseGamma(5, 1) for tau, v0 = .005</span>
ctrl6 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>, 
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,
                       <span class="dt">beta1pi =</span> <span class="dv">0</span>, <span class="dt">v0 =</span> <span class="fl">5e-03</span>)


<span class="co"># Estimate the model </span>
mod10 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>,
               <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">control =</span> ctrl6, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod10<span class="op">$</span>muW</code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376822858 -0.04443304 -0.004110117
##  [2,] -0.372325895 -0.04358556 -0.005696672
##  [3,] -0.375719676 -0.04343733 -0.004947834
##  [4,] -0.373891994 -0.04417952 -0.004672995
##  [5,] -0.377499434 -0.04330105 -0.005404333
##  [6,] -0.375807989 -0.04447934 -0.004504553
##  [7,] -0.375545922 -0.04396995 -0.004237517
##  [8,]  0.044270327 -0.37708845 -0.019689948
##  [9,]  0.043950486 -0.37294924 -0.019941341
## [10,]  0.043388634 -0.37576275 -0.018993761
## [11,]  0.043790469 -0.37125593 -0.019593898
## [12,]  0.044483556 -0.37516369 -0.019574536
## [13,]  0.044624502 -0.37452245 -0.019541209
## [14,]  0.043971197 -0.37746934 -0.018159259
## [15,]  0.002607960  0.02107537 -0.405654575
## [16,]  0.002664143  0.02120185 -0.407997814
## [17,]  0.002842471  0.02116014 -0.409084282
## [18,]  0.002533579  0.02111624 -0.406361382
## [19,]  0.002532490  0.02108300 -0.408694793
## [20,]  0.002668127  0.02094020 -0.408183022</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># SVS, priorInclusion with Beta(1,1) priors and InverseGamma(5, 1) for tau, v0 = .005</span>
ctrl7 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>,
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, <span class="dt">alphatau =</span> <span class="dv">5</span>,
                       <span class="dt">betatau =</span> <span class="dv">1</span>, <span class="dt">beta1pi =</span> <span class="dv">1</span>, <span class="dt">beta2pi =</span> <span class="dv">1</span>, 
                       <span class="dt">v0 =</span> <span class="fl">1e-03</span>)

                       
<span class="co"># Estimate the model</span>
mod11 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, 
              <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">priorInclusion =</span> <span class="fl">0.5</span>, <span class="dt">control =</span> ctrl7,
              <span class="dt">verbose =</span> <span class="ot">FALSE</span> ) </code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod11<span class="op">$</span>muW             </code></pre></div>
<pre><code>##        Component 1  Component 2  Component 3
##  [1,] -0.377585969 -0.047939333 -0.002001648
##  [2,] -0.373162862 -0.042487944 -0.002374892
##  [3,] -0.374424310 -0.040392824 -0.002183428
##  [4,] -0.375075559 -0.046537326 -0.002133489
##  [5,] -0.376001850 -0.039418960 -0.002301476
##  [6,] -0.375864889 -0.047130795 -0.002098348
##  [7,] -0.375409214 -0.045695502 -0.002031570
##  [8,]  0.043401229 -0.378488759 -0.006154046
##  [9,]  0.044375834 -0.373875543 -0.006198091
## [10,]  0.042239525 -0.377115242 -0.005992542
## [11,]  0.044761079 -0.368634823 -0.006106240
## [12,]  0.044958241 -0.376871710 -0.006118384
## [13,]  0.045641060 -0.375075551 -0.006110655
## [14,]  0.044348933 -0.377244104 -0.005812578
## [15,]  0.001435196  0.006309373 -0.405990765
## [16,]  0.001444623  0.006308304 -0.408536058
## [17,]  0.001463239  0.006364100 -0.409391471
## [18,]  0.001438362  0.006326944 -0.406792705
## [19,]  0.001422580  0.006352733 -0.409223547
## [20,]  0.001425179  0.006319707 -0.409095996</code></pre>
<p>The estimated posterior inclusion probabilities for the three models:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod9<span class="op">$</span>inclusionProbabilities</code></pre></div>
<pre><code>##             [,1]      [,2]       [,3]
##  [1,] 1.00000000 0.2120296 0.09726907
##  [2,] 1.00000000 0.2068326 0.09851144
##  [3,] 1.00000000 0.2084065 0.09897047
##  [4,] 1.00000000 0.2139049 0.09843787
##  [5,] 1.00000000 0.2044355 0.09823061
##  [6,] 1.00000000 0.2146309 0.09848977
##  [7,] 1.00000000 0.2091004 0.09793821
##  [8,] 0.21428441 1.0000000 0.11723947
##  [9,] 0.21111001 1.0000000 0.11752795
## [10,] 0.20612101 1.0000000 0.11542999
## [11,] 0.21070545 1.0000000 0.11707616
## [12,] 0.21594418 1.0000000 0.11702863
## [13,] 0.21982827 1.0000000 0.11758358
## [14,] 0.20661409 1.0000000 0.11227938
## [15,] 0.09660274 0.1179197 1.00000000
## [16,] 0.09702372 0.1193704 1.00000000
## [17,] 0.09668529 0.1185038 1.00000000
## [18,] 0.09705420 0.1192275 1.00000000
## [19,] 0.09635180 0.1178253 1.00000000
## [20,] 0.09741905 0.1191173 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod10<span class="op">$</span>inclusionProbabilities</code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
##  [1,] 1.00000000 0.14604123 0.06595144
##  [2,] 1.00000000 0.14241876 0.06677927
##  [3,] 1.00000000 0.14288168 0.06707145
##  [4,] 1.00000000 0.14595656 0.06672092
##  [5,] 1.00000000 0.14130427 0.06659022
##  [6,] 1.00000000 0.14681895 0.06675491
##  [7,] 1.00000000 0.14405489 0.06639296
##  [8,] 0.14694535 1.00000000 0.07949594
##  [9,] 0.14519685 1.00000000 0.07968820
## [10,] 0.14248443 1.00000000 0.07830934
## [11,] 0.14478837 1.00000000 0.07938071
## [12,] 0.14753285 1.00000000 0.07935458
## [13,] 0.14873386 1.00000000 0.07970621
## [14,] 0.14356166 1.00000000 0.07625060
## [15,] 0.06548873 0.08003940 1.00000000
## [16,] 0.06576005 0.08097049 1.00000000
## [17,] 0.06553993 0.08040118 1.00000000
## [18,] 0.06578191 0.08085128 1.00000000
## [19,] 0.06532184 0.07996842 1.00000000
## [20,] 0.06601984 0.08076926 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod11<span class="op">$</span>inclusionProbabilities</code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
##  [1,] 1.00000000 1.00000000 0.06864236
##  [2,] 1.00000000 1.00000000 0.06905001
##  [3,] 1.00000000 1.00000000 0.06903261
##  [4,] 1.00000000 1.00000000 0.06892463
##  [5,] 1.00000000 1.00000000 0.06891797
##  [6,] 1.00000000 1.00000000 0.06892288
##  [7,] 1.00000000 1.00000000 0.06880774
##  [8,] 1.00000000 1.00000000 0.07471343
##  [9,] 1.00000000 1.00000000 0.07480727
## [10,] 1.00000000 1.00000000 0.07439398
## [11,] 1.00000000 1.00000000 0.07467890
## [12,] 1.00000000 1.00000000 0.07465084
## [13,] 1.00000000 1.00000000 0.07471088
## [14,] 1.00000000 1.00000000 0.07374679
## [15,] 0.06814353 0.07456737 1.00000000
## [16,] 0.06827512 0.07470610 1.00000000
## [17,] 0.06806801 0.07459243 1.00000000
## [18,] 0.06826865 0.07474289 1.00000000
## [19,] 0.06804514 0.07456130 1.00000000
## [20,] 0.06823635 0.07470003 1.00000000</code></pre>
<p>It is also possible to compare the (known) variable inclusion matrix vs. the estimated ones graphically. Let’s plot a heatmap of such probabilities for model <code>mod9</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trueInclusions &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, J, <span class="dv">3</span>)
trueInclusions[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
trueInclusions[<span class="dv">8</span><span class="op">:</span><span class="dv">14</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span> 
trueInclusions[<span class="dv">15</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">1</span>

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">image</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(trueInclusions), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(trueInclusions),  
      <span class="kw">t</span>(trueInclusions[J<span class="op">:</span><span class="dv">1</span>, ]), <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, 
      <span class="dt">main =</span> <span class="st">&quot;True Inclusions&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,
      <span class="dt">col =</span>  RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Blues&quot;</span>))
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">&quot;Component &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> ))      
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">&quot;Var &quot;</span>, J<span class="op">:</span><span class="dv">1</span> )) 

fields<span class="op">::</span><span class="kw">image.plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(trueInclusions), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(trueInclusions),  
      <span class="kw">t</span>(mod9<span class="op">$</span>inclusionProbabilities[J<span class="op">:</span><span class="dv">1</span>, ]), <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, 
      <span class="dt">main =</span> <span class="st">&quot;Estimated Inclusions&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,
      <span class="dt">col =</span> RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Blues&quot;</span>))  
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">&quot;Component &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> ))          </code></pre></div>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAh1BMVEUAAAAAADoAAGYAOpAAZrYIMGsIUZwhcbU6AAA6ADo6AGY6OpA6ZmY6kNtCksZmAABmADpmkJBmtrZmtv9rrtaQOgCQOjqQtpCQ29uQ2/+eyuG2ZgC2Zma2/7a2/9u2///G2+/bkDrb2//b/7bb///e6/f3+///tmb/trb/25D//7b//9v////ZOPw2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAARI0lEQVR4nO2djXbjOBlAM9MAnYWQgVCWEqBrmMU0zfs/H5b8E0mJZVufLUv1vee0M00cWfp0I0uyLe+uAAJ2a2cA8gaBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCxpEDnXcd+zPYfL7unHzO/tx5FV3g3c/94G5XlarMHnHdf69cTiRYCLUWfQJfj1zEC6c0egED95CeJjz6BOgP89G0mFmhmlu4DVUWp5Sl2X35+3n15rQNwOe4O6tWzKVdd7EJvVP3Sr5WqBk7te9aHi7Zy2nC9P1cvHJqd3dIo7isxBoVlQJcJ/a36+i+V5aoc+1IXr2jzqoug/ltv9mZFSJfIEWj1aEUUqM6ZWarqdxunZlsdkhpdnqYROzwISbPd7XhQ3L7vZhq37eJiCXTLhC2Qgdq67LLdCGREqCqlVZJEohVTIO21WSr9/7YxMkJSvVrob0epflcbfH27C4n6+jYb1O9V36j603W42jSM7eJyO4SdrEycu1pUdhyuXRt0aIJVFaTdzIxQqVui871A60YrpkAn9a9dqrpxdUNy0lHctxsX3ffG+HC1gd1yNW37uQlGm4axXVxMgcxMWAJV+a5/19a0n9vbX66ibrqasqcVrZh9IH2MtUtltL/mUf1afxWMvuBdSJoW/dC+126rP26n0W4XF1MgMxOWQPsml41A7WGqtcGIUBvIB32gVaO1kkA6XuWuC0+77V1I9rd0upDUwW57ECezNnTzezLTMLaLi9UHMjLhEUhX36l+QW9mRKgtn1egFaK1pkDVr5Oz7ajvVNfcNyMG73fK2G7hojoUzsGgzYRHoK6ujRaojVBbvskt0MLRii5Q/W9567FZ29ohaUJQVi+Y79V9vI+/1gMPu8vYHtVvady2W7ioDpZARiY8ApVtZ8QYYHQR6usDrRytFQRq2modpHqE0uh+HxI98lAbn7ouY/vhehhhfJ3scUWXhrHdwkV1uPWBvr6ZmdB5622BdGnUC0U7HdRGqG8UtnK0ogvU9QtvB+amC/QgJO3MRts+mx8uuv6TPbOxv1ohMbaLiymQmQnVr7lNJN73gZoy6M3ezAidb8klFK3oAuliPf3n2I4IjMPtg5DU3chD1wUwP6zj00yx3eZWT7edNWl028XFEsjMhJr0/Vv/KOzLa9FOQdfV3UVI+XHq7wOtEy0u5wARCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCKmCGTey73O3Z6QHJNaoI8XvAGbaYewj5dRC/3AdpjYByqj3yEMaUMnGkQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEzCzQb0L5b2TmLfaC8fl1KpFjMVGgjxf/CrAI5GfzAl2O/nNhCORn8wJdS/8FHQjkZ/MCddeU9XiEQH42L1BfKh0I5AWBhpJDIC8I1B7Deg5hCOQHgc5PPwq1oHnPYAyB/GxeoMvxcC3V+tY9S+EjkB8EOp6u7z+96Z+HySGQl80LpGaiL99fESiQHAS6DanHlGhqH0g9UPF84BAWSBYCtbteRKDreW88s+o+OQTygkBDySGQl20LNHQm9YpAQ2xdoN3u8a3NnMoYyWcQyBhAlSN72h31A9E8GyCQn08g0OXYdYDV41kn94FUM9R/URkC+clfoPJ2GktfXRjSiS77lwdCID/ZC1TuDt0lYfqEVuAorO+6MgTyk71AV6Pu37+9BrdAfU+FRiA/eQn0eEq6E0h1gegDxSUvgR6XQSIQozAhn0qgyYew/nmg+50j0EM+l0BTO9HMRIv5VAIFD+PvYSZ6JJ9KoLCJRD8I5OfTCFSv11tMPZUxCAL5+QwCOVvPGyAE8oNAQ8khkBcEGkoOgbxkIdBvGxBofNBigUBDySGQFwQaSg6BvCDQUHII5AWBhpJDIC8I1JMKpzLGgUBDySGQFwQaSg6BvCDQUHII5AWBhpJDIC8INJQcAnlBoKHkEMgLAg0lh0BeEGgoOQTygkBDySGQFwTqSYWZ6HFsW6DLse+O5ltyCORl6wL94dn/uDAEGmDrAh2uhf/eVATyg0B6bY5+hxDIDwJp+leYQiA/WQj0u4blBPIkh0Be8heoNNdnmXhnKgKJyV4gdTt82RpUcG98bHIXqH5q93nf/LFnJjoyuQtUPyiuqHvAMwrETPRIshdILUrWLfDCISw6eQl0v8hm3f3pOkGTV6ofBIH85CXQff5tgc5VS4RAUcldIOsQJllovA8E8pO9QGYnOmydaD8I5Cd3gaxhPC1QfHIXyJ5IDOgD1Qb2g0B+shdInb1Q/tSLbJ4nj8KGlopGID/5C+Qy9RDW95ieNjkE8rJ5gdTTDjRczhHE5gXqS4VTGeNAoKHkEMgLArXHMA5hQSDQ+elHsW8mJB8lh0BeNi+QuiixfPpxLXruEEMgPwh0POkHzxsPn7eTC63Q2OJNK/ZsTNbh1wgRcfK4+2PDEgKpmejL91cECmTzAukTsedD/yEstEIRaCMCqTOx1Uisbz4agfwg0FByoRWKQBsQqP9M6m0mOrRCEWgTAg0/9ju0QhFoAwKpQZh5Y+uj5EIrFIE2IdC1bob6LypDID8IpOhfnAOBBkCghr7ryhDIDwIpqhaob7FEBPKDQPSBRGxdIEZhQrYtEPNAYrYuEDPRQrYt0JjkQisUgRBIJxdaoQiUiUDWIpvvz7OvDxRaoQiUh0DWvfHq4mYEikruAjmLbB44hEUmd4Gs9YH0alMIFJUsBPpLw4M1Eq0Vysqv/zzSB4pLXgLd599aI7HYLbBGYmiFIlCGAi2xxF1ohSJQFgJZhzDdFUKgqGQvkLXI5nwCcSpjJLkLZA3j9aktWqCo5C6Q87QeJhJjk71A9iKbCzzqILRCESgTgVwQKCoINJRcaIUiEALp5EIrFIG2I1DpuS4agfxsXaDzbnd4//2P/otbEcjPxgU6V+P+s259WGAqjG0LpNsd+6mZbSrMRI9j6wKpeeyPf19pgULZtkDtSbRWpUfJhVYoAm1BoPoKEDUO671BLLRCEWgTAg0nF1qhCIRAOrnQCkWgdAT6ewMCjQ9aLBBoKLnQCkWgDQjUPa7Q87in0ApFoA0IdP148T8xFYGG2LhAzXVoD1JhJnocWxfIMwPUJBdaoQi0DYEGkwutUARCIJ1caIUiEALp5EIrFIEQSCcXWqEIhEA6udAKRSAE0smFVigCIZBOLrRCESgTgdxbKhAoKtkLZN0br/5GoKjkLpC1OsdVnx6dJS6cyhhJ7gJZ6wOp/z1NFKg2sB8E8pOXQAOLbOo/JwrU/7iMZuehFYpACQp0n39rjUTdnEw9hPU9qrDdeWiFIlCGAgUsMNVdU8YFZUHkLpB1CGOh8fhkIdAvDUOd6MLuH80CAvnJXSB3GD+9BWqPYRzCgshdoLuJxMkCnZ9+FPumJXsAAvnJXiB7kc3rZIHUTfHqKVEsrhBG/gK5BMwDvf/0pn/MVJiJHsfmBVKdqMv3V1egW3KhFYpA2xBIj+DOBw5hgSCQGsJVI7G++WgE8oNAQ8mFVigCbUCgoTOpV4FAoYSKN6HYc5JkRJw8LinQbvf41uZbchEiJAwXAq0mkBqEeRYZ18lFiJAwXAi0okDXuhnqv6gMgfwkGREnj8t3osveU2EINECSEXHyGGUU1nddGQL5STIiTh6jtEDOPKL8VEa8cCHQugLRB5KQZEScPDIKQ6BEBWIeSEySEXHyyEw0AiUq0JjkIkRIGC4EGhKoPQ2HQAiEQPOHC4EQSBQuBEIgUbgQKEGBmIkeSZIRcfJIC4RACLRguBBIJJC5RqI6MYFAUUkyIk4evQKZtzZ/vFT/QaCoJBkRJ48+gazFFfQN7ggUlSQj4uTRJ5C7RiICRSbJiDh59Apkr5F4RaDIJBkRJ483ge4X2bSXuNNbzxsgBPKTZEScPPpaoDuBklloPF64EEggkHsIK2caxjMTPZIkI+LkcUInutgdaIGikmREnDyOHsZX/pzoA8UlyYg4eRw9kfj+fKATHZkkI+Lk0X8qw1gjMallfuOFC4FEArkgUFSSjIiTx64OEQiBUhNIn7/vX2YcgYZIMiJOHhcUqGhvai777m5GID9JRsTJ43ICGU+bm32V1njhQqDVBDLuTGV5lzCSjIiTxzVaIE5ljCTJiDh5XLQP1DRB9IECSTIiTh6XHIW1D3vq6QEh0BBJRsTJI/NACIRAC4YLgVYUSJ0+092gglFYEElGxMnjkp3oL69VN0hdDIJAYSQZESePSw/jP17UEwsRKIgkI+LkcfmJRPXcVAQKIsmIOHmMMJF43iNQGElGxMnjkn2gRpu7J84xEz2SJCPi5HHZUVh9EPt4oQUKIsmIOHlkHgiBEGjBcCEQAonChUAIJAoXAg0JdL+mggcEikqSERGVCIGikmRERCVCoKgkGRFRiRAoKklGRFQilneJSpIREZVookDGdfUPiRAgabgQaE2Bhp45FyFA0nAh0JoC9d4Q1hAhQNJwIdCaArW3ZfTdHR8hQNJwIdCaAg0RIUDScCFQygJ5dxWdeGUTk204pqbaHsP8XaFZdiX+YFYCLf+JNARS10Pvm9VeF96V+IMIJNzFAqlejodrqe7K6L25ebZdyT+IQMJdLJCqmgd6/+lN/yy8K/kHEUi4iwVSVTPRl++vCDQ3WxFI35hxPnAIm5vNCKSWub+7q2ehXUk/iEDCXayX6ry7QqBZPrG+QENnUmfc1SwfRCDhLuZOVU0i7hfJBWTL9IXGjccdAkxu11Qz5L+oDLZEyIGxDDoVBp+SwJ7VwHVlsBkCW6CAeUT4lNAHAhGMwkAE80AgIuJMNHxGcpruhwRBIBCBQCBCJJB+Bu88U0Kl3b3queJxqR0WCwwuowdnHSQC1Y+dO88Reqd/fjk+nOleaofqMstyZoOiB2clBAI19/boZ2dIsWPUc7JtqR2qW02qVGedoYgenLUQCNReF/0/VZyqWOor9/78ZzVT/f6sHgv1/u3n52baunn7clRvq3AU1gtq+1ukqy/vw3Nti+1QMbNA0YOzFuECWREvq4KrB0G9P1dtdqG+ItVhoSr5Sb/TvX05qrebn/fnQ/eCO8X0KEaL7lBvMB/Rg7Ma4QLphr+hXneq6kaocl+bXyf9r/oudm/rz1Tv1J+tAnF7YThGS+6wnPkEX/TgrMY8AtVHfB2WU/NX+0cdueZtHYrqV91jNV6YKtDsO5yntxInr59EILOVroNQFdSO0TcViS5GbShUjJr1IibFaNEdXucdhkUPzmrM0Ikud6eeL5kdo7sv2bUZYIyN0ZI77MZNMxE9OGsxzzDeOMxbrbSeCrEO805IJsVoqR02R5NZqyV6cNZCPJH48aK+MLeBhhWj6i1noFGHpB7znM2g2X3YxzFaaodVNQ6uP5t8cFZCdCpDrzZVt9XdVIcVoz89N48J76Y6mhjpqY4qDt0LZ3tapidGS+3wvGs+NiPRg7MOS55MnbdXkeIOBeSUVx8ItBI55dUHAq1ETnn1wfVAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIR/wc1Q7Y8YIGLrQAAAABJRU5ErkJggg==" alt="True and Estimated inclusion probabilities." />
<p class="caption">True and Estimated inclusion probabilities.</p>
</div>
<p>For <code>mod10</code> and <code>mod11</code> we can observe the estimated prior inclusion probabilities:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod10<span class="op">$</span>priorInclusion</code></pre></div>
<pre><code>##           [,1]
## [1,] 0.3987346
## [2,] 0.3987346
## [3,] 0.3987346</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod11<span class="op">$</span>priorInclusion</code></pre></div>
<pre><code>##           [,1]
## [1,] 0.5945308
## [2,] 0.5945308
## [3,] 0.5945308</code></pre>
<p>Similar to the hyperparameters of the Inverse Gamma priors on <span class="math inline">\(\tau\)</span>, <code>priorInclusion</code>, <code>beta1pi</code> and <code>beta2pi</code>can also be specified as <span class="math inline">\(D\)</span>-dimensional arrays. This will allow estimating the inclusion probabilities with different degrees of ‘sparsity’ for each component. For Type-II maximum likelihood updates of <code>priorInclusion</code>, all elements of <code>beta1pi</code> must be equal to 0. For Beta priors, all elements of <code>beta1pi</code> must be larger than 0. Let us look at two examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Type-II maximum likelihood (component-specific) updates </span>
ctrl8 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>, 
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,
                       <span class="dt">beta1pi =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">v0 =</span> <span class="fl">5e-03</span>)

<span class="co"># Estimate the model </span>
mod12 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, 
               <span class="dt">SVS =</span> <span class="ot">TRUE</span>, <span class="dt">priorInclusion =</span> <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">3</span>),
               <span class="dt">control =</span> ctrl8, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )</code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod12<span class="op">$</span>muW</code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376817775 -0.04443026 -0.004110336
##  [2,] -0.372360508 -0.04355404 -0.005678225
##  [3,] -0.375711830 -0.04340495 -0.004935813
##  [4,] -0.373900042 -0.04418527 -0.004666015
##  [5,] -0.377497008 -0.04324630 -0.005388196
##  [6,] -0.375809312 -0.04449066 -0.004500207
##  [7,] -0.375532827 -0.04394650 -0.004236029
##  [8,]  0.044261824 -0.37708496 -0.019640556
##  [9,]  0.043929313 -0.37297274 -0.019886136
## [10,]  0.043342443 -0.37573263 -0.018956990
## [11,]  0.043766769 -0.37127627 -0.019542974
## [12,]  0.044481053 -0.37518476 -0.019526532
## [13,]  0.044636397 -0.37455303 -0.019492259
## [14,]  0.043931728 -0.37743803 -0.018141983
## [15,]  0.002607056  0.02102946 -0.405651922
## [16,]  0.002663824  0.02115916 -0.408001417
## [17,]  0.002840070  0.02111391 -0.409084633
## [18,]  0.002532502  0.02107713 -0.406361999
## [19,]  0.002530700  0.02103708 -0.408695945
## [20,]  0.002665014  0.02089807 -0.408194788</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod12<span class="op">$</span>priorInclusion</code></pre></div>
<pre><code>##           [,1]
## [1,] 0.4294635
## [2,] 0.4359775
## [3,] 0.3399416</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod12<span class="op">$</span>inclusionProbabilities </code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
##  [1,] 1.00000000 0.16810342 0.05171407
##  [2,] 1.00000000 0.16382116 0.05235869
##  [3,] 1.00000000 0.16439404 0.05258104
##  [4,] 1.00000000 0.16809442 0.05230977
##  [5,] 1.00000000 0.16244473 0.05221079
##  [6,] 1.00000000 0.16908934 0.05233593
##  [7,] 1.00000000 0.16573007 0.05205611
##  [8,] 0.16509191 1.00000000 0.06237005
##  [9,] 0.16306252 1.00000000 0.06251995
## [10,] 0.15990420 1.00000000 0.06145088
## [11,] 0.16260305 1.00000000 0.06227781
## [12,] 0.16576567 1.00000000 0.06225943
## [13,] 0.16719978 1.00000000 0.06252745
## [14,] 0.16109063 1.00000000 0.05986055
## [15,] 0.07390531 0.09243547 1.00000000
## [16,] 0.07421527 0.09352661 1.00000000
## [17,] 0.07396456 0.09285742 1.00000000
## [18,] 0.07424059 0.09339617 1.00000000
## [19,] 0.07371601 0.09235335 1.00000000
## [20,] 0.07451101 0.09330382 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Beta priors with different degrees of sparsity for each component </span>
ctrl9 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>,
                       <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                       <span class="dt">alphatau =</span> <span class="dv">5</span>, <span class="dt">betatau =</span> <span class="dv">1</span>,
                       <span class="dt">beta1pi =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">beta2pi =</span> <span class="dv">1</span>,
                       <span class="dt">v0 =</span> <span class="fl">5e-03</span>)

                       
<span class="co"># Estimate the model</span>
mod13 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>, <span class="dt">SVS =</span> <span class="ot">TRUE</span>,
              <span class="dt">priorInclusion =</span> <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">3</span>), <span class="dt">control =</span> ctrl9, <span class="dt">verbose =</span> <span class="ot">FALSE</span> )  </code></pre></div>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod13<span class="op">$</span>muW</code></pre></div>
<pre><code>##        Component 1 Component 2  Component 3
##  [1,] -0.376823553 -0.04445292 -0.004069605
##  [2,] -0.372321780 -0.04356864 -0.005750480
##  [3,] -0.375720588 -0.04342350 -0.004970829
##  [4,] -0.373891258 -0.04421414 -0.004669279
##  [5,] -0.377499571 -0.04325604 -0.005447522
##  [6,] -0.375807748 -0.04451895 -0.004487080
##  [7,] -0.375547731 -0.04396570 -0.004205898
##  [8,]  0.044271252 -0.37708007 -0.019742308
##  [9,]  0.043952908 -0.37296691 -0.020024420
## [10,]  0.043394060 -0.37573006 -0.018982397
## [11,]  0.043792974 -0.37126432 -0.019656898
## [12,]  0.044483312 -0.37518104 -0.019620517
## [13,]  0.044621267 -0.37454675 -0.019593263
## [14,]  0.043976056 -0.37743206 -0.018045949
## [15,]  0.002608530  0.02110045 -0.405681172
## [16,]  0.002664620  0.02123110 -0.407991414
## [17,]  0.002843244  0.02118633 -0.409091995
## [18,]  0.002534198  0.02114931 -0.406372349
## [19,]  0.002533170  0.02110874 -0.408700786
## [20,]  0.002668932  0.02097038 -0.408132057</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod13<span class="op">$</span>priorInclusion</code></pre></div>
<pre><code>##           [,1]
## [1,] 0.3999559
## [2,] 0.4432304
## [3,] 0.5825461</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod13<span class="op">$</span>inclusionProbabilities    </code></pre></div>
<pre><code>##             [,1]       [,2]      [,3]
##  [1,] 1.00000000 0.17112197 0.1337330
##  [2,] 1.00000000 0.16672704 0.1354631
##  [3,] 1.00000000 0.16733858 0.1361515
##  [4,] 1.00000000 0.17115717 0.1353939
##  [5,] 1.00000000 0.16530310 0.1350775
##  [6,] 1.00000000 0.17216159 0.1354701
##  [7,] 1.00000000 0.16869081 0.1346833
##  [8,] 0.14487471 1.00000000 0.1602905
##  [9,] 0.14315770 1.00000000 0.1606833
## [10,] 0.14049548 1.00000000 0.1577618
## [11,] 0.14275404 1.00000000 0.1600890
## [12,] 0.14545003 1.00000000 0.1600062
## [13,] 0.14661853 1.00000000 0.1608249
## [14,] 0.14156091 1.00000000 0.1533005
## [15,] 0.06453304 0.09420471 1.0000000
## [16,] 0.06480003 0.09532060 1.0000000
## [17,] 0.06458335 0.09463845 1.0000000
## [18,] 0.06482151 0.09518785 1.0000000
## [19,] 0.06436869 0.09412224 1.0000000
## [20,] 0.06505576 0.09509410 1.0000000</code></pre>
</div>
<div id="high-posterior-density-intervals" class="section level2">
<h2>High posterior density intervals</h2>
<p>It is also possible to require the computation of high probability density intervals for the elements of <span class="math inline">\(W\)</span>, which can then be plotted with the <code>plothpdi</code> function, which internally calls <code>ggplot2</code> functionalities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set hyperparameter values and require 50% probability density intervals </span>
ctrl10 &lt;-<span class="st"> </span><span class="kw">vbpca_control</span>(<span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scalecorrection =</span> <span class="op">-</span><span class="dv">1</span>, 
                        <span class="dt">plot.lowerbound =</span> <span class="ot">FALSE</span>, 
                        <span class="dt">alphatau =</span> <span class="dv">2</span>, <span class="dt">betatau =</span> .<span class="dv">5</span>, 
                        <span class="dt">hpdi =</span> <span class="ot">TRUE</span>, <span class="dt">probHPDI =</span> <span class="fl">0.5</span>)

<span class="co"># Estimate the model </span>
mod14 &lt;-<span class="st"> </span><span class="kw">vbpca</span>(X, <span class="dt">D =</span> <span class="dv">3</span>, <span class="dt">maxIter =</span> <span class="fl">1e+03</span>, <span class="dt">priorvar =</span> <span class="st">'invgamma'</span>,
              <span class="dt">control =</span> ctrl10, <span class="dt">verbose =</span> <span class="ot">TRUE</span> )</code></pre></div>
<pre><code>## Local prior variances : Inverse-Gamma, fixed hyperparameters.</code></pre>
<pre><code>## Warning: unscaled data - ELBO values might be positive.</code></pre>
<pre><code>## Iteration: 1 - ELBO: -2803.52
## Start # 1 has converged in 2 iterations; lower bound = -2802.98</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot HPD intervals for variables 1:10 component 1 </span>
<span class="kw">plothpdi</span>(mod14, <span class="dt">d =</span> <span class="dv">1</span>, X, <span class="dt">vars =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="High posterior density intervals." />
<p class="caption">High posterior density intervals.</p>
</div>
</div>
<div id="retrieve-principal-components" class="section level2">
<h2>Retrieve Principal Components</h2>
<p>To compute the estimated components, simpy call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PCs &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>mod1<span class="op">$</span>muW
<span class="kw">head</span>(PCs, <span class="dv">15</span>)</code></pre></div>
<pre><code>##       Component 1 Component 2 Component 3
##  [1,]   -59.19132  -78.592706  31.3401006
##  [2,]    28.97173 -118.789001 -29.0200757
##  [3,]   -11.00518   14.227039  -4.8429359
##  [4,]    92.16140  -33.606390 -28.1184464
##  [5,]   -41.61482 -212.440556  13.4800625
##  [6,]   113.51610  -20.107248   5.6778539
##  [7,]    98.45308  -73.892682  17.2711799
##  [8,]    42.05467 -142.922656 -68.0937444
##  [9,]   -57.38540  -66.586046  17.5396890
## [10,]    42.94090   51.286634  -0.2553017
## [11,]    36.39523  -11.871548  13.9383073
## [12,]   109.60474   -6.656482  25.3900540
## [13,]  -196.01791  110.020823  -9.5996904
## [14,]  -267.42318   71.336728  14.1676674
## [15,]    38.49334   22.034659 -32.6994037</code></pre>
<div id="references" class="section level3">
<h3>References</h3>
<ol style="list-style-type: decimal">
<li>C. M. Bishop. ‘Variational PCA’. In Proc. Ninth Int. Conf. on Artificial Neural Networks. ICANN, 1999.</li>
<li>E. I. George, R. E. McCulloch (1993). ‘Variable Selection via Gibbs Sampling’. Journal of the American Statistical Association (88), 881-889.</li>
</ol>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
